15:12 16/05/2025--[10/01/2022 09:28:00]ALTER TABLE PedidoCompra ADD Referencia_Cliente varchar(15)
GO

--[20/01/2022 10:15:00]
ALTER TABLE Produtos ALTER COLUMN Codigo_SKU varchar(20)
GO

--[11/02/2022 10:29:00]
ALTER TABLE SimulaProdutos ADD Aliquota_PISSai float
                              ,Aliquota_COFINSSai float
                              ,Valor_PISSai money,Valor_COFINSSai money
GO
--[12/02/2022 15:30:00]
ALTER TABLE SimulaProdutos ADD Valor_UnitarioSaida money
GOALTER TABLE SimulaImportacao ADD Tipo_NotaSai smallint
GO
ALTER TABLE SimulaProdutos ADD Valor_BCICMS money
GOALTER TABLE SimulaProdutos ADD Valor_BCPIS money
GO
ALTER TABLE SimulaProdutos ADD Valor_BCIPI money
GOALTER TABLE SimulaImportacao ADD Valor_IPISai money
GO
ALTER TABLE SimulaImportacao ADD Valor_IPISai moneyGOALTER TABLE SimulaProdutos ADD Valor_IPISai money
GO
ALTER TABLE SimulaImportacao ADD Valor_PISSai money
                                ,Valor_COFINSSai Money 
GO
ALTER TABLE SimulaImportacao ADD Total_NFSaida money
GO
ALTER TABLE SimulaImportacao ADD Total_Produtos money
GO
ALTER TABLE SimulaImportacao ADD Valor_Despesas money
GO
ALTER TABLE SimulaProdutos ADD Valor_UnitarioReal money
GO

--[14/02/2022 19:08:00]
ALTER TABLE SimulaProdutos ADD Valor_CIFReal money
GO

--[19/02/2022 09:54:00]
ALTER TABLE SimulaDespesas ADD Classificacao varchar(15)
GO
UPDATE SimulaDespesas SET Classificacao = (SELECT MAX(Codigo) FROM ClassificacaoFinanceira CF WHERE CF.Descricao = SimulaDespesas.Despesa AND Desativada <> 1)
GO

--[19/02/2022 11:12:00]
ALTER TABLE SimulaDespesas ADD Custo bit
GO
UPDATE SimulaDespesas SET Custo = (SELECT Custo FROM ClassificacaoFinanceira WHERE Codigo = Classificacao)
GO

--[21/02/2022 07:55:00]
ALTER TABLE SimulaImportacao ADD BCIPI_Entrada money
                                ,BCIPI_Saida money       
GO

--[25/02/2022 10:23:00]
CREATE TABLE ProcessosDocumentosDocs ( Processo varchar(15)
                                      ,Documento varchar(120)
                                      )
GO

--[26/02/2022 11:02:00]
ALTER TABLE SimulaProdutos ADD BCII_Entrada money
GO
ALTER TABLE SimulaImportacao ADD BCII_Entrada money
GO
exec sp_RENAME 'SimulaProdutos.Aliquota_IpI', 'Aliquota_IPI', 'COLUMN'
GO

--[26/02/2022 13:35:00]
UPDATE TipoNota SET Codigo = (SELECT ISNULL(MAX(Codigo), 0) +1 FROM TipoNota) WHERE Codigo = 0
GO

--[02/03/2022 09:45:00]
exec sp_RENAME 'SimulaProdutos.Valor_BCPIS', 'Valor_BCPISEnt', 'COLUMN'
GO
ALTER TABLE SimulaProdutos ADD Valor_BCPISSai money
GO

--[02/03/2022 15:41:00]
ALTER TABLE SimulaProdutos ADD Fator float
GO


--[03/03/2022 11:51:00]
ALTER TABLE SimulaImportacao ADD BCICMSST money
                                ,Valor_ICMSST money
GO
ALTER TABLE SimulaProdutos ADD Aliquota_ICMSRed float
                              ,Aliquota_ICMSST float
                              ,BCICMSST money
                              ,Valor_ICMSST money
GO

--[03/03/2022 11:51:00]
UPDATE NotasFiscais SET Envio_Armazem = 1 WHERE Saida_Entrada = 1
GO

--[04/03/2022 18:24:00]
ALTER TABLE SimulaProdutos ADD Aliquota_ICMS float
GO          

--[08/03/2022 09:59:00]
ALTER TABLE SimulaProdutos ADD Valor_UnitarioME money
GO

--[15/03/2022 09:07:00]
DELETE FROM SimulaProdutos WHERE Item is null or Simulacao is null
GO

--[18/03/2022 16:19:00]
ALTER TABLE Clientes ADD Conta_Propria bit
                        ,Conta_Ordem bit
                        ,Encomenda bit
                        ,Outros bit
GO
UPDATE Clientes set Conta_Propria = 0
                   ,Conta_Ordem = 0
                   ,Encomenda = 0
                   ,Outros = 0
GO
UPDATE Clientes set Conta_Propria = 1 where Modalidade_Importacao = 1
GO
UPDATE Clientes set Conta_Ordem = 1 where Modalidade_Importacao = 2
GO
UPDATE Clientes set Encomenda = 1 where Modalidade_Importacao = 3
GO
UPDATE Clientes set Outros = 1 where Conta_Propria <> 1 and Conta_Ordem <> 1 and Encomenda <> 1
GO
ALTER TABLE Fornecedores ADD Conta_Propria bit
                            ,Conta_Ordem bit
                            ,Encomenda bit
                            ,Outros bit
GO
UPDATE Fornecedores set Conta_Propria = 0
                       ,Conta_Ordem = 0
                       ,Encomenda = 0
                       ,Outros = 0
GO
UPDATE Fornecedores set Conta_Propria = 1 where Modalidade_Importacao = 1
GO
UPDATE Fornecedores set Conta_Ordem = 1 where Modalidade_Importacao = 2
GO
UPDATE Fornecedores set Encomenda = 1 where Modalidade_Importacao = 3
GO
UPDATE Fornecedores set Outros = 1 where Conta_Propria <> 1 and Conta_Ordem <> 1 and Encomenda <> 1
GO


--[22/03/2022 12:36:00]
CREATE TABLE ClientesModalidades (Cliente int
                                 ,Codigo smallint
                                 )
GO

--[22/03/2022 13:24:00]
ALTER TABLE ClientesModalidades DROP COLUMN Descricao
GO
CREATE TABLE FornecedoresModalidades (Fornecedor int
                                     ,Codigo smallint
                                     )
GO
ALTER TABLE Clientes DROP COLUMN Conta_Ordem, Conta_Propria, Encomenda, Outros
GO
ALTER TABLE Fornecedores DROP COLUMN Conta_Ordem, Conta_Propria, Encomenda, Outros
GO
TRUNCATE TABLE ClientesModalidades
go
TRUNCATE TABLE FornecedoresModalidades
go
INSERT INTO ClientesModalidades SELECT Codigo, Modalidade_Importacao FROM Clientes WHERE Modalidade_Importacao is not null
GO
INSERT INTO FornecedoresModalidades SELECT Codigo, Modalidade_Importacao FROM Fornecedores WHERE Modalidade_Importacao is not null
GO

--[23/03/2022 15:22:00]
ALTER TABLE ClientesModalidades ADD Conta_Ativo varchar(15)
                                   ,Conta_Adiantamento varchar(15)
                                   ,Conta_Devolucao varchar(15)
GO


--[23/03/2022 16:29:00]
ALTER TABLE Clientes ADD Conta_Propria bit
                        ,Conta_Ordem bit
                        ,Encomenda bit
                        ,Outros bit
GO
UPDATE Clientes set Conta_Propria = 0
                   ,Conta_Ordem = 0
                   ,Encomenda = 0
                   ,Outros = 0
GO
UPDATE Clientes set Conta_Propria = 1 where Modalidade_Importacao = 1
GO
UPDATE Clientes set Conta_Ordem = 1 where Modalidade_Importacao = 2
GO
UPDATE Clientes set Encomenda = 1 where Modalidade_Importacao = 3
GO
UPDATE Clientes set Outros = 1 where Conta_Propria <> 1 and Conta_Ordem <> 1 and Encomenda <> 1
GO
ALTER TABLE Fornecedores ADD Conta_Propria bit
                            ,Conta_Ordem bit
                            ,Encomenda bit
                            ,Outros bit
GO
UPDATE Fornecedores set Conta_Propria = 0
                       ,Conta_Ordem = 0
                       ,Encomenda = 0
                       ,Outros = 0
GO
UPDATE Fornecedores set Conta_Propria = 1 where Modalidade_Importacao = 1
GO
UPDATE Fornecedores set Conta_Ordem = 1 where Modalidade_Importacao = 2
GO
UPDATE Fornecedores set Encomenda = 1 where Modalidade_Importacao = 3
GO
UPDATE Fornecedores set Outros = 1 where Conta_Propria <> 1 and Conta_Ordem <> 1 and Encomenda <> 1
GO

--[24/03/2022 10:24:00]
ALTER TABLE Clientes DROP COLUMN Conta_Ordem, Conta_Propria, Encomenda, Outros
GO
ALTER TABLE Fornecedores DROP COLUMN Conta_Ordem, Conta_Propria, Encomenda, Outros
GO
ALTER TABLE FornecedoresModalidades ADD Conta_Passivo varchar(15)
                                       ,Conta_Adiantamento varchar(15)
                                       ,Conta_Devolucao varchar(15)
GO
TRUNCATE TABLE ClientesModalidades
GO
TRUNCATE TABLE FornecedoresModalidades
GO
INSERT INTO ClientesModalidades     SELECT Codigo, Modalidade_Importacao, Conta_Ativo, Conta_Adiantamento, Conta_Devolucao FROM Clientes     WHERE Modalidade_Importacao is not null
GO
INSERT INTO FornecedoresModalidades SELECT Codigo, Modalidade_Importacao, Conta      , Conta_Adiantamento, Conta_Devolucao FROM Fornecedores WHERE Modalidade_Importacao is not null
GO

--[05/04/2022 10:10:00]
ALTER TABLE TiposProcesso ADD Processo bit
GO
ALTER TABLE TiposProcesso ADD Exportacao bit
GO
UPDATE TiposProcesso SET Exportacao = CASE WHEN Descricao LIKE '%EXPORTA%' THEN 1 ELSE 0 END
GO
UPDATE TiposProcesso SET Processo = 1
GO
UPDATE TiposProcesso SET Processo = 0 WHERE Descricao LIKE '%OUTROS%' OR Descricao LIKE '%NENHUM%'
GO

--[17/05/2022 11:06:00]
ALTER TABLE PedidosDespesas ALTER COLUMN Valor_Total float
GO
ALTER TABLE PedidosDespesas ALTER COLUMN Valor_Nota float
GO

--[25/05/2022 09:43:00]
ALTER TABLE PagarReceber ADD Permuta_Recebimento bit
GO
UPDATE PagarReceber SET Permuta_Recebimento = 0 where Permuta_Recebimento is null
GO
UPDATE PagarReceber SET Recuperavel = 0 where Permuta_Recebimento is null
GO

--[26/05/2022 10:51:00]
ALTER TABLE TiposProcesso ADD Conta_FornecedorExt varchar(15)
GO

--[26/05/2022 14:34:00]
ALTER TABLE ClassificacaoFinanceira ADD Tributo bit
GO
UPDATE ClassificacaoFinanceira set Tributo = isnull((select Tributo from cybersoft_Cadastros.dbo.TiposDocumentos where Codigo = Tipo_Documento), 0)
GO

--[30/05/2022 16:52:00]
ALTER TABLE Bancos ADD Historico smallint
GO

--[31/05/2022 08:06:00]
ALTER TABLE TipoNota ADD Formula_DIFAL text
                        ,Calculo_DIFAL text
GO

--[31/05/2022 10:20:00]
UPDATE TipoNota SET Formula_DIFAL = 'Valor da base de c lculo do ICMS Operacional * (Aliquota do ICMS do estado destino/100)  -  Valor do ICMS Operacional do Item'
                   ,Calculo_DIFAL = 'PedidosItens_[Valor_BCICMSOper] * (PedidosItens_[Aliquota_ICMSDest]/100)  -  PedidosItens_[Valor_ICMSOper]'
WHERE isnull(Visiveis_DIFAL, 0) = 1
GO

--[03/06/2022 14:33:00]
ALTER TABLE NotasFiscais ADD Cancelada_ForaPrazo bit
GO

--[08/06/2022 09:52:00]
CREATE TABLE TempReg450 (Codigo varchar(6)
                        ,Descricao varchar(60)
                        ,Ordem varchar(6)
			)
GO

--[10/06/2022 11:55:00]
UPDATE TipoNota SET Formula_DIFAL = 'Valor da base de c lculo do ICMS Operacional * (Aliquota do ICMS do estado destino/100)  -  Valor do ICMS Operacional do Item'
                   ,Calculo_DIFAL = 'PedidosItens_[Valor_BCICMSOper] * (PedidosItens_[Aliquota_ICMSDest]/100)  -  PedidosItens_[Valor_ICMSOper]'
WHERE isnull(Visiveis_DIFAL, 0) = 1 
AND  Formula_DIFAL LIKE 'Valor da base de c lculo do ICMS Operacional * (Aliquota do ICMS do estado destino/100)  -  Valor do ICMS Operacional do Item'
GO

--[20/06/2022 15:12:00]
ALTER TABLE ECommerce ADD Servico varchar(25)
GO
ALTER TABLE ECommerce ADD Token text
GO

--[27/06/2022 10:57:00]
UPDATE PagarReceber SET Documento = (Select Codigo from Cybersoft_Cadastros.dbo.TiposDocumentos where Descricao = Forma_Tipo) 
WHERE Documento is null
GO

--[27/06/2022 16:51:00]
ALTER TABLE PagarReceberBaixas ADD Lote int
GO
ALTER TABLE PagarReceber ADD Lote int
GO

--[05/07/2022 09:31:00]
ALTER TABLE TipoNota ADD Formula_BCDIFAL text
                        ,Calculo_BCDIFAL text
GO
ALTER TABLE PedidosItens ADD Valor_BCDIFAL money
GO
ALTER TABLE NotasItens ADD Valor_BCDIFAL money
GO
ALTER TABLE Pedidos ADD Valor_BCDIFAL money
GO
ALTER TABLE NotasFiscais ADD Valor_BCDIFAL money
GO
UPDATE TipoNota SET Formula_BCDIFAL = '(Valor da base de c lculo do ICMS Operacional - Valor do ICMS Operacional do Item)/((100 - Aliquota do ICMS do estado destino)/100)'
                   ,Calculo_BCDIFAL = '(PedidosItens_[Valor_BCICMSOper] - PedidosItens_[Valor_ICMSOper])/((100 - PedidosItens_[Aliquota_ICMSDest])/100)'
WHERE isnull(Visiveis_DIFAL, 0) = 1 
AND  Formula_DIFAL LIKE '((((Valor da base de c lculo do ICMS Operacional - Valor do ICMS Operacional do Item) / ((100 - Aliquota do ICMS do estado destino)/100))) * (Aliquota do ICMS do estado destino/100)) - Valor do ICMS Operacional do Item'
GO
UPDATE TipoNota SET Formula_DIFAL = '(Valor da BASE Calculo do DIFAL * (Aliquota do ICMS do estado destino/100)) - Valor do ICMS Operacional do Item'
                   ,Calculo_DIFAL = '(PedidosItens_[Valor_BCDIFAL] * (PedidosItens_[Aliquota_ICMSDest]/100)) - PedidosItens_[Valor_ICMSOper]'
WHERE isnull(Visiveis_DIFAL, 0) = 1 
AND  Formula_DIFAL LIKE '((((Valor da base de c lculo do ICMS Operacional - Valor do ICMS Operacional do Item) / ((100 - Aliquota do ICMS do estado destino)/100))) * (Aliquota do ICMS do estado destino/100)) - Valor do ICMS Operacional do Item'
GO
UPDATE TipoNota SET Formula_BCDIFAL = 'Valor da base de c lculo do ICMS Operacional'
                   ,Calculo_BCDIFAL = 'PedidosItens_[Valor_BCICMSOper]'
WHERE isnull(Visiveis_DIFAL, 0) = 1 
AND  Formula_DIFAL LIKE 'Valor da base de c lculo do ICMS Operacional * (Aliquota do ICMS do estado destino/100)  -  Valor do ICMS Operacional do Item'
GO
UPDATE TipoNota SET Formula_DIFAL = '(Valor da BASE Calculo do DIFAL * (Aliquota do ICMS do estado destino/100)) - Valor do ICMS Operacional do Item'
                   ,Calculo_DIFAL = '(PedidosItens_[Valor_BCDIFAL] * (PedidosItens_[Aliquota_ICMSDest]/100)) - PedidosItens_[Valor_ICMSOper]'
WHERE isnull(Visiveis_DIFAL, 0) = 1 
AND  Formula_DIFAL LIKE 'Valor da base de c lculo do ICMS Operacional * (Aliquota do ICMS do estado destino/100)  -  Valor do ICMS Operacional do Item'
GO
UPDATE TipoNota SET Formula_BCDIFAL = 'Valor da base de c lculo do ICMS Operacional / (1-(Aliquota do ICMS do estado destino/100))'
                   ,Calculo_BCDIFAL = 'PedidosItens_[Valor_BCICMSOper] / (1-(PedidosItens_[Aliquota_ICMSDest] /100))'
WHERE isnull(Visiveis_DIFAL, 0) = 1 
AND  Formula_DIFAL LIKE '(Valor da base de c lculo do ICMS Operacional / (1-(Aliquota do ICMS do estado destino /100))) * ((Aliquota do ICMS do estado destino - Aliquota do ICMS Operacional) /100)'
GO
UPDATE TipoNota SET Formula_DIFAL = '(Valor da BASE Calculo do DIFAL * (Aliquota do ICMS do estado destino/100)) - Valor do ICMS Operacional do Item'
                   ,Calculo_DIFAL = 'PedidosItens_[Valor_BCDIFAL] * ((PedidosItens_[Aliquota_ICMSDest] - PedidosItens_[Aliquota_ICMSOper])/100)'
WHERE isnull(Visiveis_DIFAL, 0) = 1 
AND  Formula_DIFAL LIKE '(Valor da base de c lculo do ICMS Operacional / (1-(Aliquota do ICMS do estado destino /100))) * ((Aliquota do ICMS do estado destino - Aliquota do ICMS Operacional) /100)'
GO

--[15/09/2022 16:46:00]
ALTER TABLE Invoice ADD DI varchar(10)
GO
CREATE TABLE DIAcrescimo (Registro int
                         ,DI varchar(10)
                         ,Codigo smallint
                         ,Valor money
			 ,Moeda int
			 )
GO

--[16/09/2022 17:03:00]
ALTER TABLE DIAdicoes ADD Item smallint
GO
ALTER TABLE DIAdicoes DROP COLUMN Item
GO

--[20/09/2022 15:40:00]
ALTER TABLE Fornecedores ADD Vinculo_CompVend smallint
GO
UPDATE Fornecedores SET Vinculo_CompVend = 2 WHERE Estado = 'EX'
GO
ALTER TABLE Fornecedores ADD Relacao_ExpFab smallint
GO
UPDATE Fornecedores SET Relacao_ExpFab = 2 WHERE Estado = 'EX'
GO
ALTER TABLE DIAdicoes ADD Relacao_ExpFab smallint
GO
ALTER TABLE DIAdicoes add Peso_Bruto float
GO
ALTER TABLE DIAdicoes ADD Aliquota_COFINS float
                         ,Aliquota_PIS float
GO

--[21/09/2022 11:23:00]
ALTER TABLE DI ADD Total_MercadoriaReal money
GO

--[21/09/2022 15:23:00]
ALTER TABLE DIAdicoes ADD Valor_MercadoriaReal money
GO

--[22/09/2022 10:15:00]
ALTER TABLE DIAdicoes ADD Aliquota_RedCOFINS float
GO

--[22/09/2022 17:27:00]
ALTER TABLE Invoice ADD Local_Condicao varchar(30)
                       ,Metodo_Valoracao smallint
GO
ALTER TABLE DIAdicoes ADD Local_Condicao varchar(30)
                         ,Metodo_Valoracao smallint
GO

--[23/09/2022 11:15:00]
EXEC sp_rename 'dbo.Invoice.Cotacao', 'Taxa_Cambio', 'COLUMN'
GO

--[23/09/2022 17:55:00]
ALTER TABLE Invoice add Cobertura_Cambial smallint
GO

--[25/09/2022 07:34:00]
ALTER TABLE Invoice ADD Financiadora smallint
GO
ALTER TABLE DIAdicoes ADD Financiadora smallint
GO

--[26/09/2022 15:38:00]
ALTER TABLE Invoice ADD Motivo_SemCobertura smallint
GO

--[27/09/2022 10:24:00]
ALTER TABLE Invoice ADD Aplicacao varchar(7)
GO
UPDATE Invoice SET Aplicacao = 'REVENDA'
GO
ALTER TABLE DIAdicoes ALTER COLUMN Aplicacao varchar(7)
GO
UPDATE DIAdicoes SET Aplicacao = 'REVENDA'
GO
ALTER TABLE NCM ADD NALADI_NCCA varchar(7)
GO
EXEC sp_rename 'dbo.DIAdicoes.NALADI_NCC', 'NALADI_NCCA', 'COLUMN'
GO
ALTER TABLE Invoice ADD Condicao_Mercadoria varchar(5)
GO
UPDATE Invoice SET Condicao_Mercadoria = 'NOVA'
GO
ALTER TABLE DIAdicoes ADD Condicao_Mercadoria varchar(5)
GO
ALTER TABLE DIAdicoes ADD Unidade varchar(10)
GO
UPDATE DIAdicoes set Unidade = (Select MIN(Descricao) FROM Cybersoft_Cadastros.dbo.UnidadeMedida WHERE Codigo = (select Unidade from NCM where NCM.NCM = DIAdicoes.NCM))
GO

--[28/09/2022 09:57:00]
ALTER TABLE InvoiceItens ADD Fabricante smallint
GO
UPDATE InvoiceItens SET Fabricante = (select Fabricante from Produtos where Codigo = Codigo_Mercadoria)
GO

--[28/09/2022 16:40:00]
EXEC sp_rename 'dbo.DIAdicoes.Acordo_Tarifario', 'Acordo_TarifarioII', 'COLUMN'
GO
ALTER TABLE DIAdicoes ADD Acordo_TarifarioIICod smallint
GO
ALTER TABLE NCM ADD Acordo_TarifarioIICod smallint
GO
ALTER TABLE DIAdicoes ADD Aliquota_II float
GO
ALTER TABLE DIAdicoes ADD Aliquota_ReducaoII float
GO
ALTER TABLE DI ADD Regime_Tributario smallint
GO

--[29/09/2022 14:44:00]
ALTER TABLE NCM ADD II_Reduzida float
GO
ALTER TABLE DIAdicoes ADD II_Reduzida float
GO
ALTER TABLE Invoice ADD Seguro float
                       ,Moeda_Seguro smallint
GO

--[03/10/2022 11:37:00]
EXEC sp_rename 'dbo.DIAcrescimo.Valor', 'Valor_ME', 'COLUMN'
GO
ALTER TABLE DIACrescimo ADD Valor_Real money
GO
CREATE TABLE AdicoesAcrescimo ( Registro int
                               ,DI varchar(10)
                               ,Adicao int
                               ,Codigo smallint
                               ,Moeda smallint
                               ,Valor_ME money
                               ,Valor_Real money
                              )
GO
ALTER TABLE DI ADD Total_AcrescimoReal money
GO

--[04/10/2022 10:55:00]
ALTER TABLE DI ADD Fundamento_Legal smallint
GO
ALTER TABLE DI ADD Motivo_AdmissaoTemp smallint
GO

--[05/10/2022 09:13:00]
ALTER TABLE DIAdicoes ADD Valor_BCII money
                         ,Aliquota_IPI float
                         ,Valor_BCIPI money
                         ,Valor_IPI money
                         ,Valor_BCPIS money
                         ,Valor_PIS money
			 ,Valor_BCCOFINS money
			 ,Valor_COFINS money
			 ,Valor_BCICMS money
			 ,Valor_ICMS money
                         ,Aliquota_RedPIS float
GO

--[06/10/2022 09:37:00]
EXEC sp_rename 'dbo.DI.Regime_Tributario', 'Regime_TributacaoII', 'COLUMN'
GO
ALTER TABLE NCM ADD IPI_AliqEspRecip float
                   ,IPI_AliqEspUnid float
                   ,Aliquota_RedIPI float
GO
ALTER TABLE DIAdicoes ADD Aliquota_IPIEspRec float
                         ,Aliquota_IPIEspUnid float
GO

--[07/10/2022 08:19:00]
ALTER TABLE Invoice ADD Pais_Aquisicao smallint
GO

--[08/10/2022 10:45:00]
ALTER TABLE NCM ADD ICMS_Importacao float
GO

--[10/10/2022 08:56:00]
ALTER TABLE NCM ADD Regime_TribPISCOFINS smallint
GO
ALTER TABLE DIAdicoes ADD Reducao_BCPISCOFINS float
GO
ALTER TABLE NCM ADD Fundamento_RedPISCOFINS smallint
GO

--[11/10/2022 12:12:00]
ALTER TABLE DI ADD Recinto_AduaneiroSetor smallint
GO

--[14/10/2022 11:45:00]
ALTER TABLE SimulaProdutos ADD Aliquota_MVA float
GO

--[17/10/2022 09:59:00]
ALTER TABLE SimulaProdutos ADD Valor_BCMVA money
                              ,Valor_MVA money
GO

--[17/10/2022 16:18:00]
ALTER TABLE DI ADD Tipo_Conhecimento smallint
GO

--[17/10/2022 18:18:00]
ALTER TABLE DI ADD Documento_Chegada varchar(15)
GO

--[18/10/2022 17:46:00]
ALTER TABLE Clientes ADD Importador bit
GO
ALTER TABLE Invoice ADD Modalidade_Importacao smallint
                       ,Transportador smallint
GO
ALTER TABLE DIAdicoes ALTER COLUMN Unidade varchar(25)
GO

--[20/10/2022 09:43:00]
ALTER TABLE DI DROP COLUMN Transportador
GO
ALTER TABLE DI ALTER COLUMN Agente_Transportador varchar(50)
GO

--[21/10/2022 13:38:00]
ALTER TABLE POItens ALTER COLUMN Valor float
GO

--[21/10/2022 15:14:00]
ALTER TABLE Fabricantes ADD Estado_Nome varchar(30)
GO
ALTER TABLE Fornecedores ADD Estado_Nome varchar(30)
GO
UPDATE Fornecedores SET Estado_Nome = (SELECT Nome FROM Cybersoft_Cadastros.dbo.Estados where Codigo = Estado)
GO

--[24/10/2022 10:07:00]
ALTER TABLE NCM ADD Regime_TribII smallint
GO
ALTER TABLE DI DROP COLUMN Regime_TributacaoII
GO
ALTER TABLE DIAdicoes ADD Regime_TribII smallint
GO
ALTER TABLE DI ADD Agente_Numero varchar(20)
GO

--[25/10/2022 09:54:00]
CREATE TABLE DIDocumentos (DI varchar(10)
                          ,Codigo smallint
                          ,Numero varchar(20)
                          )
GO

--[25/10/2022 11:46:00]
ALTER TABLE DI ADD Tipo_Embalagem smallint
GO
ALTER TABLE DI ADD Volumes_Embalagem smallint
GO
ALTER TABLE DI ADD Frete_TerritorioNac money
GO
exec sp_RENAME 'Invoice.Frete_Inter', 'Frete_PrePaid', 'COLUMN'
GO
ALTER TABLE Invoice ADD Frete_Collect money
GO

--[27/10/2022 11:19:00]
ALTER TABLE InvoiceItens ADD PO varchar(15)
GO

--[28/10/2022 18:36:00]
ALTER TABLE SimulaDespesas ADD Custo_Saida bit
GO

--[31/10/2022 09:31:00]
ALTER TABLE SimulaProdutos ADD Valor_BCIPISai money
GO

--[31/10/2022 17:50:00]
ALTER TABLE SimulaImportacao ADD Total_NFEntrada money
GO

--[01/11/2022 09:33:00]
ALTER TABLE SimulaImportacao ADD Valor_DespesasSai money
GO

--[03/11/2022 09:16:00]
ALTER TABLE SimulaProdutos ADD Valor_UnitarioImpSai money
                              ,Valor_UnitarioimpEnt money
GO

--[17/11/2022 11:54:00]
ALTER TABLE Configuracao ADD Tela_LiberaPedidos bit
GO
UPDATE Configuracao SET Tela_LiberaPedidos = 1
GO
ALTER TABLE PedidosRepresentantes ADD Sel bit
GO

--[18/11/2022 14:44:00]
ALTER TABLE Configuracao DROP COLUMN Pasta_BackupLocal
GO

--[18/11/2022 17:25:00]
ALTER TABLE PedidosRepresentantes ADD Aguardando_Conferencia bit
                                     ,Aguardando_Cliente bit
GO

--[26/11/2022 16:04:00]
ALTER TABLE PedidosRepresentantes ADD Local smallint
GO
UPDATE PedidosRepresentantes SET Local = 0
GO

--[27/11/2022 14:24:00]
ALTER TABLE PedidosRepresentantes ALTER COLUMN Situacao varchar(20)
GO

--[28/11/2022 13:58:00]
ALTER TABLE ProcessosDocumentos ADD Recinto_AlfandegarioCod int
GO

--[30/11/2022 13:37:00]
ALTER TABLE PedidosRepresentantes ADD Alterado bit
GO

--[13/12/2022 10:08:00]
ALTER TABLE PedidosRepresentantesItens ADD Codigo_SKU varchar(15)
GO

--[13/12/2022 17:30:00]
ALTER TABLE ProdutosLinhas ADD Comissao float
GO

--[14/12/2022 10:26:00]
ALTER TABLE TabelaComissoes ADD Percentual_Venda float
GO
ALTER TABLE PedidosRepresentantes ADD Ordem_Compra varchar(20)
GO

--[03/01/2023 09:25:00]
ALTER TABLE Produtos ADD Quantidade_CaixaMaster float
GO

--[11/01/2023 10:54:00]
ALTER TABLE ReferenciasFiscais ADD Sinal_BCIPI char(1)
                                  ,Sinal_BCICMSOper char(1)
                                  ,Sinal_BCICMSST char(1)
                                  ,Sinal_BCFrete char(1)
GO

--[11/01/2023 14:48:00]
UPDATE ReferenciasFiscais SET Sinal_BCIPI = '+'
GO

--[26/01/2023 09:44:00]
ALTER TABLE PedidosRepresentantes ADD Data_Despacho datetime
GO
ALTER TABLE PedidosRepresentantesItens add Tabela_Comissao smallint
GO

--[26/01/2023 16:26:00]
ALTER TABLE Configuracao ADD ECommerce_Valor bit
GO
UPDATE Configuracao SET ECommerce_Valor = 0
GO

--[27/01/2023 10:20:00]
ALTER TABLE PedidosRepresentantes ADD Novo bit
GO
UPDATE PedidosRepresentantes set novo = 0
GO

--[30/01/2023 09:39:00]
ALTER TABLE Configuracao add Classificacao_PagamentoPF varchar(15)
GO

--[31/01/2023 16:21:00]
ALTER TABLE PedidosRepresentantes ADD Data_Planilha datetime
GO

--[01/02/2023 14:15:00]
ALTER TABLE PedidosRepresentantes ADD Planilha varchar(80)
GO

--[03/02/2023 11:38:00]
ALTER TABLE PedidosRepresentantes ADD Gera_Boleto bit
                                     ,Local_Entrega text
GO
UPDATE PedidosRepresentantes SET Gera_Boleto = 1
GO

--[06/02/2023 11:31:00]
ALTER TABLE Configuracao ADD Classificacao_RecebimentoComBol varchar(15)
                            ,Classificacao_RecebimentoSemBol varchar(15)
                            ,Tempo_Verificacao int
GO

--[06/02/2023 08:50:00]
ALTER TABLE PedidosRepresentantes ALTER COLUMN Cliente_Telefone varchar(15)
GO

--[09/02/2023 10:55:00]
ALTER TABLE PedidosRepresentantes ALTER COLUMN Vendedor varchar(80)
GO

--[09/02/2023 15:21:00]
UPDATE PedidosRepresentantes set Inf_Complementares2 = null where Origem_Pedido = 'E-COMMERCE' and Data < '02/09/2023'
GO

--[10/02/2023 15:58:00]
UPDATE ProcessosDocumentos set Modalidade_Importacao = (SELECT Codigo FROM TiposProcesso WHERE isnull(Exportacao, 0) = 1) WHERE RTRIM(Tipo) = 'EXPORTA  O'
GO

--[13/02/2023 09:00:00]
ALTER TABLE Boletos ADD Pedido varchar(15)
GO
update Boletos set Pedido = (select Fiscal from PagarReceber where Numero = Financeiro_Numero)
GO

--[16/02/2023 09:38:00]
ALTER TABLE PedidosRepresentantes add Data_Liberacao datetime
                                     ,Data_Conferencia datetime
                                     ,Data_Faturamento datetime
GO

--[23/02/2023 16:09:00]
ALTER TABLE TabelaComissoes ADD Desativada bit
GO
UPDATE TabelaComissoes SET Desativada = 0
GO

--[27/02/2023 11:02:00]
ALTER TABLE Log ALTER COLUMN Funcao varchar(12)
GO

--[02/03/2023 10:47:00]
ALTER TABLE NotasTerceiros ADD Tipo_Pagamento smallint
GO
UPDATE NotasTerceiros set Tipo_Pagamento = 2 where Tipo_Pagamento is null
GO

--[07/03/2023 14:46:00]
UPDATE NotasFiscais set Tipo_Pagamento = 2 where Tipo_Pagamento is null
GO
ALTER TABLE NotasTerceiros ADD Complementar bit
GO
UPDATE NotasTerceiros set Complementar = 0 WHERE Complementar is NULL
GO

--[08/03/2023 16:16:00]
ALTER TABLE PedidosRepresentantes ADD Usuario varchar(15)
GO
UPDATE PedidosRepresentantes SET Usuario = 'ADM01'
GO

--[13/03/2023 15:00:00]
UPDATE PedidosRepresentantes SET Total_Pedido = (select SUM(Valor_Unitario * Quantidade) from PedidosRepresentantesItens Pri where Pri.Pedido = 'E1852') WHERE Pedido = 'E1852'
GO

--[16/03/2023 15:34:00]
ALTER TABLE Boletos ADD Pedido varchar(15)
GO
UPDATE Boletos SET Pedido = (SELECT Fiscal FROM PagarReceber WHERE Numero = Financeiro_Numero)
GO

--[30/03/2023 16:01:00]
ALTER TABLE ContratoCambio ADD Pago_Cliente bit
GO
UPDATE ContratoCambio SET Pago_Cliente = 0
GO

--[05/04/2023 14:23:00]
ALTER TABLE PedidosRepresentantes ADD Data_Separacao datetime
GO
UPDATE PedidosRepresentantes SET Data_Separacao = Data_Despacho
GO
UPDATE PedidosRepresentantes SET Local = (Local+1) WHERE Local > 2 AND (select COUNT(*) from PedidosRepresentantes where Local = 5) = 0
GO
UPDATE PedidosRepresentantes SET Local = 0 WHERE Local IS NULL
GO

--[06/04/2023 08:38:00]
ALTER TABLE PedidosRepresentantesItens ADD Quantidade_Devol float
GO
ALTER TABLE ProdutosTransferencia ADD Pedido varchar(15)
GO

--[06/04/2023 15:05:00]
ALTER TABLE Configuracao ADD Classificacao_DevolucaoPedido varchar(15)
GO
ALTER TABLE PedidosRepresentantes ADD Numero_Financeiro int
GO

--[06/04/2023 17:41:00]
UPDATE Configuracao SET Aparencia = 'Cyber001C' WHERE ISNULL(Aparencia, '') = ''
GO

--[12/04/2023 15:32:00]
ALTER TABLE Bancos ADD Lancamento_Contabil bit
GO
UPDATE Bancos SET Lancamento_Contabil = 1
GO

--[13/04/2023 11:53:00]
ALTER TABLE Configuracao ADD Tempo_RefreshRep smallint
GO

--[25/04/2023 16:45:00]
EXEC sp_rename 'dbo.Produtos.Beneficio_Fiscal', 'Beneficio_FiscalEnt', 'COLUMN';
GO
ALTER TABLE Produtos ALTER COLUMN Beneficio_FiscalEnt varchar(8)
GO
ALTER TABLE Produtos ADD Beneficio_FiscalSai varchar(8)
GO
ALTER TABLE PedidosItens ADD Beneficio_Fiscal varchar(8)
GO
ALTER TABLE NotasItens ADD Beneficio_Fiscal varchar(8)
GO
ALTER TABLE TipoNota ADD Beneficio_Fiscal varchar(8)
GO

--[27/04/2023 11:57:00]
ALTER TABLE TipoNota ADD Diferido_ICMS bit
GO
UPDATE TipoNota SET Diferido_ICMS = 0 WHERE Diferido_ICMS IS NULL
GO

--[04/05/2023 16:14:00]
ALTER TABLE Pedidos ADD Valor_ICMSDif money
                       ,Aliquota_ICMSDif float
GO
ALTER TABLE PedidosItens ADD Valor_ICMSDif money
                            ,Aliquota_ICMSDif float
GO
ALTER TABLE NotasFiscais ADD Valor_ICMSDif money
                            ,Aliquota_ICMSDif float
GO
ALTER TABLE NotasItens ADD Valor_ICMSDif money
                          ,Aliquota_ICMSDif float
GO

--[05/05/2023 13:46:00]
ALTER TABLE Pedidos DROP COLUMN Aliquota_ICMSDif
GO
ALTER TABLE NotasFiscais DROP COLUMN Aliquota_ICMSDif
GO

--[08/05/2023 14:12:00]
ALTER TABLE DI ADD Indicativo_Conhec smallint
GO

--[08/05/2023 14:17:00]
EXEC sp_rename 'dbo.DI.Regime_Tributario', 'Regime_TributacaoII', 'COLUMN'
GO

--[12/05/2023 14:33:00]
ALTER TABLE Boletos ADD Valor_Multa money
GO

--[31/05/2023 11:21:00]
ALTER TABLE SimulaProdutos ADD Valor_BCICMSEnt money
GO

--[13/06/2023 09:03:00]
update ProdutosSeriaisNotas Set Numero = ltrim(rtrim(Numero))
go
update ProdutosSeriaisNotas Set Numero = 'CXG00955C001H0214' where numero = '  CXG00955C001H0214  '
go
update ProdutosSeriaisNotas Set Numero = 'CXG00955J001H0218' where numero = '  CXG00955J001H0218 '
go
update ProdutosSeriaisNotas Set Numero = 'CXG00935CJ0H00149' where numero = 'CXG00935CJ0H00149 /'
go

--[28/06/2023 10:51:00]
ALTER TABLE ProcessosFechamento ADD Transferencia_Efetuada money
                                   ,Transferencia_Recebida money
                                   ,Devolucoes money
GO

--[03/07/2023 09:21:00]
ALTER TABLE TipoNota ADD TTD bit
GO
UPDATE TipoNota SET TTD = 0
GO

--[23/08/2023 09:07:00]
ALTER TABLE PedidosItens ADD Aliquota_ICMSReducao2 float
                            ,Percentual_Beneficio float
GO

--[23/08/2023 10:36:00]
ALTER TABLE NotasItens ADD Aliquota_ICMSReducao2 float
                          ,Percentual_Beneficio float
GO

--[23/08/2023 15:55:00]
ALTER TABLE NCM ADD 
 AC_Reducao2 float
,AL_Reducao2 float
,AM_Reducao2 float
,AP_Reducao2 float
,BA_Reducao2 float
,CE_Reducao2 float
,DF_Reducao2 float
,ES_Reducao2 float
,GO_Reducao2 float
,MA_Reducao2 float
,MG_Reducao2 float
,MS_Reducao2 float
,MT_Reducao2 float
,PA_Reducao2 float
,PB_Reducao2 float
,PE_Reducao2 float
,PI_Reducao2 float
,PR_Reducao2 float
,RJ_Reducao2 float
,RN_Reducao2 float
,RO_Reducao2 float
,RR_Reducao2 float
,RS_Reducao2 float
,SC_Reducao2 float
,SE_Reducao2 float
,SP_Reducao2 float
,TO_Reducao2 float
,EX_Reducao2 float
GO

--[12/09/2023 16:22:00]
ALTER TABLE SimulaDespesas ADD Valor_ME money
                              ,Taxa float
GO

CREATE TABLE REINF (Registro int
                   ,Registro_REINF varchar(10)
                   ,Data date
                   ,Recibo varchar(20)
                   ,Protocolo varchar(20)
                   )
GO

--[13/09/2023 11:30:00]
ALTER TABLE Configuracao ADD Percentual_Seguro float
                            ,Minimo_Seguro money
GO

--[13/09/2023 15:42:00]
ALTER TABLE Configuracao ADD Percentual_Marinha float
                            ,Tarifa_Marinha money
GO

--[14/09/2023 08:51:00]
UPDATE SimulaDespesas SET Taxa = (SELECT Taxa_FOB FROM SimulaImportacao si WHERE si.Numero = Simulacao)
                         ,Valor_ME = Valor / (SELECT Taxa_FOB FROM SimulaImportacao si WHERE si.Numero = Simulacao)
WHERE isnull(Taxa, 0) = 0
GO
ALTER TABLE SimulaDespesas ALTER COLUMN Registro bigint null
GO
UPDATE SimulaDespesas SET Classificacao = (SELECT MAX(Codigo) FROM ClassificacaoFinanceira WHERE Descricao = Despesa)
GO

--[18/09/2023 10:18:00]
ALTER TABLE REINF ADD Arquivo varchar(160)
GO
exec sp_RENAME 'REINF.Registro_REINF', 'Evento', 'COLUMN'
GO
ALTER TABLE REINF Add Evento_ID varchar(40)
GO
ALTER TABLE REINF ADD Protocolo_Data date
GO
exec sp_RENAME 'REINF.Data', 'Data_Envio', 'COLUMN'
GO

--[19/09/2023 14:31:00]
ALTER TABLE PropostaExp ADD Condicao_Frete varchar(60)
GO
ALTER TABLE Invoice ADD Condicao_Frete varchar(60)
GO
ALTER TABLE SimulaProdutos ADD Aliquota_ICMSRed2 float
GO

--[20/09/2023 09:14:00]
ALTER TABLE DI ADD Regime_TributacaoII smallint
GO

--[21/09/2023 09:53:00]
ALTER TABLE TipoNota ADD Formula_VlrICMSDeson text
                       , Calculo_VlrICMSDeson text
GO
ALTER TABLE Produtos ADD ICMS_Desonerado bit
GO
UPDATE Produtos SET ICMS_Desonerado = 0
GO

--[29/09/2023 16:47:00]
ALTER TABLE Boletos ADD Numero_Envio int
GO

--[09/10/2023 14:19:00]
ALTER TABLE REINF ADD Contribuinte_CNPJ varchar(14)
                     ,Contribuinte_Nome varchar(60)
GO

--[24/10/2023 16:57:00]
UPDATE PedidosRepresentantes set Local = Local+1 where Local > 3
GO

--[30/10/2023 09:13:00]
ALTER TABLE Produtos ADD Valor_II money
                        ,Valor_PIS money
                        ,Valor_COFINS money
GO

--[10/11/2023 08:12:00]
ALTER TABLE Configuracao ADD Modelo_Simulacao bit
GO
UPDATE Configuracao SET Modelo_Simulacao = 0
GO

--[17/11/2023 09:42:00]
ALTER TABLE SimulaImportacao ADD Produto_Destinado varchar(50)
GO

--[20/11/2023 11:01:00]
ALTER TABLE ClassificacaoFinanceira ADD Despesa_AgMaritima bit
GO
UPDATE ClassificacaoFinanceira SET Despesa_Agmaritima = 0
GO

--[24/11/2023 10:02:00]
ALTER TABLE PedidosRepresentantes ADD Autorizado bit
GO
UPDATE  PedidosRepresentantes SET Autorizado = 1 WHERE isnull(Local, 0) > 0
GO

--[25/11/2023 17:13:00]
ALTER TABLE Configuracao ADD Autorizacao_Pedidos bit
GO
UPDATE Configuracao SET Autorizacao_Pedidos = 0
GO

--[29/11/2023 14:53:00]
ALTER TABLE SimulaImportacao ADD Taxa_Servico float
GO
ALTER TABLE PedidosRepresentantes ADD Tipo_Pgto char(1)
GO

--[30/11/2023 10:54:00]
DELETE FROM SimulaDespesas WHERE Registro IS NULL
GO

--[30/11/2023 14:03:00]
DELETE FROM SimulaProdutos WHERE Simulacao is null
GO

--[04/12/2023 15:56:00]
ALTER TABLE SimulaImportacao ADD Aliquota_PISServ float
                                ,Aliquota_COFINSServ float
                                ,Aliquota_IRPJServ float
                                ,Aliquota_CSLLServ float
                                ,Aliquota_ISSServ float
GO

--[19/12/2023 13:54:00]
CREATE TABLE ControleNavios ( Registro int
                             ,Ordem int
                             ,Processo varchar(15) 
                             ,Navio varchar(30)
                             ,UF char(2)
                             ,Premium float
                             ,Transhipment float	
                             ,Fator_Conversao float
                             ,Descarga_LT float	
                             ,Descarga_Trigger float
                             ,Variacao_Termica int
                             ,Data_Chegada DateTime
                             ,Data_Estimada DateTime
                             ,Data_Atracacao DateTime
                             ,Data_Descarga DateTime
                             ,Filial smallint
                             ,Volume_MT15 float
                             ,Volume_M315 float
                             ,Volume_M320 float
                             ,Qtde_Endossado float
                             ,Tipo_Descarga varchar(30)
                             ,Valor_Demurrage money
                             ,Tempo_Demurrage float
                             ,Total_ME money
                             ,Custo_Navio money
                             ,Observacao text
                             ,Status varchar(15)
                            )
GO

--[20/12/2023 14:10:00]
ALTER TABLE ProcessosDocumentos ADD Navio_Ordem int
GO

--[20/12/2023 16:39:00]
ALTER TABLE Configuracao ADD Navio_FatorConversao float
GO
ALTER TABLE ContratoCambioItens ADD Navio_Ordem int
GO

--[21/12/2023 11:03:00]
ALTER TABLE PedidosRepresentantes ADD Registro int
GO
select Pedido, ROW_NUMBER() OVER(ORDER BY Pedido ASC) AS Reg into #tmp from PedidosRepresentantes
GO
UPDATE PedidosRepresentantes SET Registro = (select Reg from #tmp where #tmp.Pedido = PedidosRepresentantes.Pedido)
GO
DROP TABLE #Tmp
GO

--[22/12/2023 09:21:00]
ALTER TABLE Clientes ADD Bloqueado bit
                        ,Terminal bit
                        ,Comprador bit
GO
UPDATE Clientes SET Bloqueado = 0 where Bloqueado is null
GO
UPDATE Clientes SET Terminal = 0 where Terminal is null
GO
UPDATE Clientes SET Comprador = 1 where Comprador is null
GO
UPDATE Clientes SET Simples_Nacional = 0 where Simples_Nacional is null
GO
UPDATE Clientes SET MEI = 0 where MEI is null
GO
UPDATE Clientes SET Consumidor_Final = 0 where Consumidor_Final is null
GO
UPDATE Clientes SET Zona_Franca = 0 where Zona_Franca is null
GO
UPDATE Clientes SET InscricaoST = 0 where InscricaoST is null
GO
UPDATE Clientes SET Micro_Empresa = 0 where Micro_Empresa is null
GO
UPDATE Clientes SET Importador = 0 where Importador is null
GO

--[22/12/2023 17:49:00]
ALTER TABLE TiposProcesso ADD Classificacao_TUP varchar(15)
GO

--[26/12/2023 18:47:00]
ALTER TABLE ProcessosDocumentos ADD TUP money
GO

--[27/12/2023 11:50:00]
ALTER TABLE Produtos ADD CSTICMS_Entrada char(3)
                        ,CSTICMS_Saida char(3)
GO

--[27/12/2023 14:30:00]
ALTER TABLE Produtos ADD Percentual_ICMSMono float
                        ,Percentual_ICMSMonoRet float
                        ,Percentual_BioDiesel float
GO
UPDATE Produtos SET Percentual_ICMSMono = 0
                   ,Percentual_ICMSMonoRet = 0
                   ,Percentual_BioDiesel = 0
WHERE Percentual_ICMSMono IS NULL
GO
ALTER TABLE Pedidos ADD Valor_ICMSMono money
                       ,Valor_ICMSMonoRet money
                       ,Valor_BCICMSMono money
                       ,Valor_BCICMSMonoRet money
GO
ALTER TABLE PedidosItens ADD Valor_ICMSMono money
                            ,Valor_ICMSMonoRet money
                            ,Percentual_ICMSMono float
                            ,Percentual_ICMSMonoRet float
			    ,Valor_BCICMSMono money
			    ,Valor_BCICMSMonoRet money
GO
ALTER TABLE NotasFiscais ADD Valor_ICMSMono money
                            ,Valor_ICMSMonoRet money
                            ,Valor_BCICMSMono money
                            ,Valor_BCICMSMonoRet money
GO
ALTER TABLE NotasItens ADD Valor_ICMSMono money
                          ,Valor_ICMSMonoRet money
                          ,Percentual_ICMSMono float
                          ,Percentual_ICMSMonoRet float
                          ,Valor_BCICMSMono money
                          ,Valor_BCICMSMonoRet money
GO
ALTER TABLE TipoNota ADD Formula_BCICMSMono text
                        ,Calculo_BCICMSMono text
                        ,Formula_ICMSMono text
                        ,Calculo_ICMSMono text
                        ,Formula_BCICMSMonoRet text
                        ,Calculo_BCICMSMonoRet text
                        ,Formula_ICMSMonoRet text
                        ,Calculo_ICMSMonoRet text
GO


--[29/12/2023 15:04:00]
ALTER TABLE Produtos DROP COLUMN Percentual_Antecipcao
GO
ALTER TABLE Produtos ADD Percentual_Antecipacao float
GO

--[04/01/2024 07:56:00]
ALTER TABLE TabelaComissoes ADD Tabela_Padrao bit
GO
UPDATE TabelaComissoes SET Tabela_Padrao = 0 WHERE Tabela_Padrao IS NULL
GO
UPDATE TabelaComissoes SET Tabela_Padrao = 1 WHERE Percentual_Venda = (select MAX(Percentual_Venda) from TabelaComissoes)
GO

--[05/01/2024 10:07:00]
ALTER TABLE PagarReceber ADD Navio int
GO

--[08/01/2024 10:04:00]
ALTER TABLE PagarReceber ADD Codigo_Barras varchar(50)
GO
ALTER TABLE PagarReceber ADD Chave_PIX varchar(60)
GO

--[11/01/2024 10:01:00]
ALTER TABLE PagarReceber ADD Filial smallint
GO
UPDATE PagarReceber SET Filial = 0 WHERE Filial IS NULL
GO

--[12/01/2024 08:02:00]
ALTER TABLE PagarReceber ADD Taxa_ME float
                            ,Valor_ME money
GO

--[12/01/2024 11:27:00]
ALTER TABLE PagarReceberBaixas ALTER COLUMN Forma_Tipo varchar(25)
GO

--[12/01/2024 14:11:00]
ALTER TABLE PedidosRepresentantes ADD Data_Autorizacao datetime
GO
ALTER TABLE Produtos ADD Preco_Minimo money
GO

--[12/01/2024 17:25:00]
ALTER TABLE PedidosItens ADD Navio int
GO
ALTER TABLE NotasItens ADD Navio int
GO

--[15/01/2024 15:29:00]
ALTER TABLE PedidosRepresentantes ADD Pedido_Pai varchar(10)
GO
ALTER TABLE PedidosRepresentantes ADD Parcial char(1)
GO

--[15/01/2024 18:09:00]
ALTER TABLE PedidosRepresentantesItens ADD Pedido_Pai varchar(10)
GO

--[16/01/2024 14:03:00]
ALTER TABLE Produtos ADD Estoque_Navio bit
GO
UPDATE Produtos SET Estoque_Navio = 0 WHERE Estoque_Navio IS NULL
GO

--[16/01/2024 14:18:00]
ALTER TABLE NotasTerceirosItens ADD Navio int
GO

--[16/01/2024 21:42:00]
CREATE TABLE Recap( 
    Registro       int 
   ,Recap_Padrao   smallint
   ,Pedido         varchar(10)
   ,Vendedor       smallint
   ,Comprador      smallint
   ,Produto        int 
   ,Entrega        varchar(60)
   ,Volume         float
   ,Preco          money
   ,Condicao_Pgto  text
   ,Garantia       text
   ,Custo_Porto    money
   ,Demurrage      varchar(9) 
   ,Inspetor       varchar(9) 
   ,AFRMM          varchar(9) 
   ,Nacionalizacao varchar(9) 
   ,Impostos       text
   ,Janela_Entrega text
   ,Periodo_Precif text
   ,Trigger_Precif text
   ,Outros_Termos  text
   )
GO

--[17/01/2024 13:42:00]
ALTER TABLE Configuracao ADD Tela_ItensTelevendas bit
GO
UPDATE Configuracao SET Tela_ItensTelevendas = 0 WHERE Tela_ItensTelevendas IS NULL
GO

--[18/01/2024 23:53:00]
ALTER TABLE Configuracao ADD Obrigar_NavioPedido bit
GO
UPDATE Configuracao SET Obrigar_NavioPedido = 0 WHERE Obrigar_NavioPedido IS NULL
GO

--[19/01/2024 08:45:00]
ALTER TABLE Produtos ALTER COLUMN Preco_Minimo float
GO
ALTER TABLE PedidosRepresentantes ADD 
       INCOTERM char(3)
      ,Terminal_Entrega varchar(60)
      ,Formacao_Preco varchar(80)
      ,Valor_Garantia money
      ,Valor_CustoPorto money
      ,Data_JanelaIni datetime
      ,Data_JanelaFim datetime
      ,Tipo_Venda char(7)
      ,Volume varchar(60)
GO
ALTER TABLE PedidosRepresentantesItens ADD Valor_Minimo float
GO

--[22/01/2024 13:39:00]
CREATE TABLE PedidosItensNavios ( Registro int
                                 ,Pedido int
                                 ,Saida_Entrada smallint
                                 ,Codigo_Mercadoria smallint
                                 ,Item smallint
                                 ,Navio smallint
                                 ,Quantidade float
                                 ,Cancelada bit
                                 ,Denegada bit
                                )
GO
CREATE TABLE NotasItensNavios ( Registro int
                               ,Nota int
                               ,Data_Emissao datetime
                               ,Saida_Entrada smallint
                               ,Codigo_Mercadoria smallint
                               ,Item smallint
                               ,Navio smallint
                               ,Quantidade float
                               ,Cancelada bit
                               ,Denegada bit
                               ,Emissor char(1)
                              )
GO

--[25/01/2024 18:09:00]
ALTER TABLE PedidosRepresentantes ADD Data_Retirada datetime
                                     ,Data_Pagamento datetime
                                     ,Percentual_Diferenca float
GO

--[26/01/2024 13:20:00]
ALTER TABLE PedidosRepresentantes ADD Demurrage varchar(10)
                                     ,Inspetor varchar(10)
                                     ,AFRMM varchar(10)
                                     ,Nacionalizacao varchar(10)
                                     ,Valor_MultaAtraso money
GO
ALTER TABLE PedidosRepresentantes ALTER COLUMN Tipo_Venda varchar(11)
GO

--[26/01/2024 15:46:00]
ALTER TABLE PedidosRepresentantes DROP COLUMN Pedido_Pai
GO
ALTER TABLE PedidosRepresentantesItens DROP COLUMN Pedido_Pai
GO
ALTER TABLE PedidosRepresentantes ADD Pedido_Pai varchar(10)
                                     ,Pedido_Pai2 varchar(10)
GO
ALTER TABLE PedidosRepresentantesItens ADD Pedido_Pai varchar(10)
                                          ,Pedido_Pai2 varchar(10)
GO
ALTER TABLE PedidosRepresentantes ADD Modal_Carregamento varchar(25)
GO
ALTER TABLE Pedidos ADD Transporte_CPFMotorista varchar(14)
GO
ALTER TABLE NotasFiscais ADD Transporte_CPFMotorista varchar(14)
GO

--[30/01/2024 08:31:00]
ALTER TABLE PedidosRepresentantes DROP COLUMN Pedido_Pai
GO
ALTER TABLE PedidosRepresentantes DROP COLUMN Pedido_Pai2
GO
ALTER TABLE PedidosRepresentantes ADD Pedido_Pai varchar(10)
GO
ALTER TABLE PedidosRepresentantes ADD Pedido_Pai2 varchar(10)
GO
ALTER TABLE PedidosRepresentantesItens DROP COLUMN Pedido_Pai
GO
ALTER TABLE PedidosRepresentantesItens DROP COLUMN Pedido_Pai2
GO
ALTER TABLE PedidosRepresentantesItens ADD Pedido_Pai varchar(10)
GO
ALTER TABLE PedidosRepresentantesItens ADD Pedido_Pai2 varchar(10)
GO

--[30/01/2024 09:36:00]
ALTER TABLE PedidosRepresentantes DROP COLUMN Formacao_Preço
GO

--[31/01/2024 09:56:00]
ALTER TABLE PedidosRepresentantes DROP COLUMN Formacao_Preco
GO
ALTER TABLE PedidosRepresentantes ADD 
       INCOTERM char(3)
      ,Terminal_Entrega varchar(60)
      ,Formacao_Preco varchar(80)
      ,Valor_Garantia money
      ,Valor_CustoPorto money
      ,Data_JanelaIni datetime
      ,Data_JanelaFim datetime
      ,Tipo_Venda char(7)
      ,Volume varchar(60)
GO
ALTER TABLE Produtos ALTER COLUMN Preco_Minimo float
GO

--[31/01/2024 10:28:00]
DELETE FROM PedidosRepresentantes WHERE Pedido IN('E233', 'E232', 'E131')
GO

--[01/02/2024 10:14:00]
ALTER TABLE PedidosRepresentantes DROP COLUMN Formacao_Preço
GO
ALTER TABLE PedidosRepresentantes ADD Formacao_Preco varchar(80)
GO

--[03/02/2024 09:59:00]
ALTER TABLE NotasItensNavios ADD DI varchar(10)
GO
ALTER TABLE PedidosItensNavios ADD DI varchar(10)
GO

--[08/02/2024 12:15:00]
ALTER TABLE ProcessosDocumentos ADD Estoque_Bloqueado bit
GO
UPDATE ProcessosDocumentos SET Estoque_Bloqueado = 0
GO

--[08/02/2024 16:11:00]
UPDATE NotasItensNavios SET Navio = (select Ordem from ControleNavios where ControleNavios.Registro = NotasItensNavios.Navio)
GO
UPDATE PedidosItensNavios SET Navio = (select Ordem from ControleNavios where ControleNavios.Registro = PedidosItensNavios.Navio)
GO

--[09/02/2024 09:47:00]
ALTER TABLE NotasTerceiros ADD Valor_IR money
                              ,Valor_CSLL money
                              ,Valor_INSS money
GO
ALTER TABLE NotasTerceirosItens ADD Valor_IR money
                                   ,Valor_CSLL money
                                   ,Valor_INSS money
GO

--[09/02/2024 16:59:00]
ALTER TABLE PedidosRepresentantesItens ALTER COLUMN Valor_Unitario float
GO

--[14/02/2024 14:58:00]
ALTER TABLE PedidosRepresentantes ALTER COLUMN Tipo_Venda varchar(11)
GO
UPDATE PedidosRepresentantes SET Tipo_Venda = 'SPOT' WHERE Tipo_Venda = 'Spot'
GO
UPDATE PedidosRepresentantes SET Tipo_Venda = 'HEATING OIL' WHERE Tipo_Venda <> 'SPOT'
GO

--[22/02/2024 18:16:00]
ALTER TABLE TipoNota ADD CFOP_Dentro varchar(4)
                        ,CFOP_Fora   varchar(4)
GO

--[28/02/2024 09:08:00]
ALTER TABLE ReferenciasFiscais ADD Transferencia bit
GO
UPDATE ReferenciasFiscais SET Transferencia = 0
GO

--[29/02/2024 13:38:00]
ALTER TABLE ClassificacaoFinanceira ADD Nivel_Codigo smallint
GO
UPDATE ClassificacaoFinanceira SET Nivel_Codigo = Nivel
GO

--[04/03/2024 13:21:00]
ALTER TABLE PedidosRepresentantesItens ADD Quantidade_Original float
GO
UPDATE PedidosRepresentantesItens SET Quantidade_Original = Quantidade WHERE Pedido_Pai IS NULL AND Pedido_PAI2 IS NULL
GO
ALTER TABLE PedidosRepresentantes ADD Total_PedidoOriginal Money
GO
UPDATE PedidosRepresentantes SET Total_PedidoOriginal = Total_Pedido WHERE Pedido_Pai IS NULL AND Pedido_PAI2 IS NULL
GO
UPDATE PedidosRepresentantes SET Total_Pedido = 612293.6305 
                                ,Total_PedidoOriginal =  7429665.67500 
WHERE Pedido = 'T8'
GO
UPDATE PedidosRepresentantesItens SET Quantidade_Original = 300000 WHERE Pedido = 'T8'
GO

--[07/03/2024 15:37:00]
ALTER TABLE Inventario ADD Aliquota_IPI float
GO

--[12/03/2024 15:59:00]
ALTER TABLE Pedidos ADD Transporte_Lacre varchar(15)
                       ,Reboque_Lacre varchar(15)
GO
ALTER TABLE PedidosRepresentantes ADD Terminal_EntregaCod smallint
GO
UPDATE PedidosRepresentantes set Terminal_EntregaCod = 103
GO
ALTER TABLE NotasFiscais ADD Transporte_Lacre varchar(15)
                            ,Reboque_Lacre varchar(15)
GO

--[12/03/2024 17:49:00]
ALTER TABLE Pedidos ADD Armazem smallint
GO
ALTER TABLE NotasFiscais ADD Armazem smallint
GO

--[13/03/2024 09:04:00]

ALTER TABLE Pedidos ADD Armazem_Nome varchar(50)
                       ,Armazem_CNPJ varchar(14)
                       ,Armazem_IE varchar(15)
                       ,Armazem_Endereco text
GO
ALTER TABLE NotasFiscais ADD Armazem_Nome varchar(50)
                            ,Armazem_CNPJ varchar(14)
                            ,Armazem_IE varchar(15)
                            ,Armazem_Endereco text
GO

--[13/03/2024 17:19:00]
ALTER TABLE Pedidos ALTER COLUMN Transporte_Placa varchar(30)
GO
ALTER TABLE Pedidos ALTER COLUMN Reboque_Placa varchar(30)
GO
ALTER TABLE NotasFiscais ALTER COLUMN Transporte_Placa varchar(30)
GO
ALTER TABLE NotasFiscais ALTER COLUMN Reboque_Placa varchar(30)
GO

--[14/03/2024 11:28:00]
ALTER TABLE ProcessosDocumentos ADD Armazem smallint
GO

--[14/03/2024 20:15:00]
ALTER TABLE Pedidos ALTER COLUMN Transporte_Lacre text
GO
ALTER TABLE Pedidos ALTER COLUMN Reboque_Lacre text
GO
ALTER TABLE NotasFiscais ALTER COLUMN Transporte_Lacre text
GO
ALTER TABLE NotasFiscais ALTER COLUMN Reboque_Lacre text
GO

--[16/03/2024 10:47:00]
CREATE TABLE PagarReceberCreditos (Registro int
                                  ,Codigo smallint
                                  ,CNPJ varchar(14)
                                  ,CPF  varchar(14)
                                  ,Tipo char(1)
                                  ,Nota int
                                  ,Data Datetime
                                  ,Emissor char(1)
                                  ,Origem char(3)
                                  ,Valor money
                                  )
GO

--[17/03/2024 10:02:00]
UPDATE PedidosRepresentantesItens SET Quantidade_Original = Quantidade WHERE isnull(Quantidade_Original, 0) = 0
GO
ALTER TABLE PedidosRepresentantesItens ADD Quantidade_Baixada float
GO
ALTER TABLE PedidosRepresentantes ADD Data_Baixa datetime
GO

--[18/03/2024 18:29:00]
ALTER TABLE SimulaImportacao ADD Destacar_ImpCred bit
GO
UPDATE SimulaImportacao SET Destacar_ImpCred = 0
GO

--[19/03/2024 17:05:00]
CREATE TABLE ControleNaviosBL (Registro int
                              ,Navio int
                              ,BL varchar(15)
                              ,Data_Emissao datetime
                              ,Quantidade_Declarada float
                              ,Quantidade_Embarcada float
                              ,Variacao_Embarque float
                              ,Media_Lotes float
                              ,Endossado bit
                              ,Bloqueado bit
                              ,DI varchar(10)
                              ,Quantidade_DI float
                              ,Quantidade_DesembarcadaDI float
                              ,Quantidade_Laudo float
                              ,Variacao_Desembarque float
                              ,Saldo float)
GO

--[21/03/2024 17:58:00]
DROP TABLE ControleNaviosBL
GO
CREATE TABLE ControleNaviosBL (Registro int
                              ,Navio int
                              ,BL int
                              ,Data_Emissao datetime
                              ,Ton_Vac float
                              ,Ton_Air float
                              ,Quantidade_15C float
                              ,Quantidade_20C float
                              ,Quantidade_LT float
                              ,Endossado bit
                              ,Bloqueado bit
                              ,DI varchar(10)
                              ,Observacao text)
GO

--[22/03/2024 14:51:00]
ALTER TABLE ControleNavios ADD Porto varchar(30)
                              ,Armazem smallint
GO

--[23/03/2024 09:16:00]
UPDATE ProcessosDocumentos SET Data = Processo_Abertura WHERE Data IS NULL
GO

--[25/03/2024 14:20:00]
CREATE TABLE ControleNaviosLaudo (Laudo int
                                 ,Navio smallint
                                 ,BL smallint
                                 ,Porto varchar(30)
                                 ,Armazem smallint
                                 ,Data_Atracacao datetime
                                 ,Data_Operacao datetime
                                 ,Quantidade_DeclaradaM3 float
                                 ,Quantidade_DeclaradaLT float
                                 ,Quantidade_RecebidaM3 float
                                 ,Quantidade_RecebidaLT float
                                 ,Var_LT float
                                 ,Var_Perc float
                                 ,Obervacao text)
GO
ALTER TABLE ControleNavios DROP COLUMN Porto
                                      ,Armazem
GO
ALTER TABLE ControleNaviosBL ADD Laudo int
GO

--[26/03/2024 16:18:00]
ALTER TABLE TipoNota ADD Monofasico_Comb bit
                        ,Monofasico_CombRetencao bit
		        ,Monofasico_CombDiferido bit
			,Monofasico_CombAnterior bit
GO
UPDATE TipoNota SET Monofasico_Comb = 0
                   ,Monofasico_CombRetencao = 0
		   ,Monofasico_CombDiferido = 0
                   ,Monofasico_CombAnterior = 0
GO

--[28/03/2024 16:25:00]
ALTER TABLE ControleNaviosLaudo ALTER COLUMN Laudo varchar(15)
GO
ALTER TABLE ControleNaviosBL ALTER COLUMN Laudo varchar(15)
GO

--[28/03/2024 17:43:00]
EXEC sp_rename 'dbo.ControleNaviosLaudo.Var_LT', 'Variacao_LT', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosLaudo.Var_Perc', 'Variacao_Perc', 'COLUMN'
GO

--[01/04/2024 17:01:00]
ALTER TABLE ControleNaviosLaudo DROP COLUMN BL
GO

--[02/04/2024 18:29:00]
ALTER TABLE NotasItensNavios DROP COLUMN Cancelada, Denegada
GO
ALTER TABLE PedidosItensNavios DROP COLUMN Cancelada, Denegada
GO
ALTER TABLE NotasItensNavios ADD Quantidade_Devol float
GO
UPDATE NotasItensNavios SET Quantidade_Devol = 0
GO

--[03/04/2024 08:39:00]
ALTER TABLE NotasItensNavios ADD Nota_Referencia int
                                ,Data_Referencia datetime
GO

--[04/04/2024 15:01:00]
EXEC sp_rename 'dbo.ControleNaviosBL.Quantidade_15c', 'Quantidade_15', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosBL.Quantidade_20c', 'Quantidade_20', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosBL.Quantidade_LT', 'Quantidade_LT20', 'COLUMN'
GO
ALTER TABLE ControleNaviosBL ADD Quantidade_LT15 float
GO
EXEC sp_rename 'dbo.ControleNavios.Volume_M315', 'Quantidade_15', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNavios.Volume_M320', 'Quantidade_20', 'COLUMN'
GO
ALTER TABLE ControleNavios ADD Quantidade_LT15 float
                              ,Quantidade_LT20 float
GO
ALTER TABLE ControleNavios DROP COLUMN Volume_MT15 
GO

--[08/04/2024 11:46:00]
ALTER TABLE Clientes ADD Valor_RADAR money
GO

--[09/04/2024 09:33:00]
ALTER TABLE Configuracao ADD Empresa_Financeiro varchar(14)
GO

--[10/04/2024 09:57:00]
ALTER TABLE Bancos ADD Data_Saldo datetime
GO

--[10/04/2024 15:12:00]
ALTER TABLE Produtos ADD Percentual_ICMSMonoSai float
GO

--[10/04/2024 16:05:00]
ALTER TABLE ControleNaviosLaudo ADD Variacao_EmbLT float
                                   ,Variacao_EmbPerc float
GO
EXEC sp_rename 'dbo.ControleNaviosLaudo.Variacao_LT', 'Variacao_DesLT', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosLaudo.Variacao_Perc', 'Variacao_DesPerc', 'COLUMN'
GO
ALTER TABLE ControleNavios ADD Terminal_Destino varchar(30)
GO

--[12/04/2024 11:11:00]
ALTER TABLE ReferenciasFiscais ADD Natureza_RefDentro varchar(4)
                                  ,Natureza_RefFora varchar(4)
GO

--[16/04/2024 14:50:00]
ALTER TABLE ProcessosDocumentos ADD Numero_BL varchar(15)
GO

--[18/04/2024 09:21:00]
SELECT Registro = ROW_NUMBER() OVER(ORDER BY Laudo ASC)
      ,[Laudo]
      ,[Navio]
      ,[Porto]
      ,[Armazem]
      ,[Data_Atracacao]
      ,[Data_Operacao]
      ,[Quantidade_DeclaradaM3]
      ,[Quantidade_DeclaradaLT]
      ,[Quantidade_RecebidaM3]
      ,[Quantidade_RecebidaLT]
      ,[Variacao_DesLT]
      ,[Variacao_DesPerc]
      ,[Obervacao]
      ,[Variacao_EmbLT]
      ,[Variacao_EmbPerc]
INTO #Temp
FROM ControleNaviosLaudo
GO
DROP TABLE ControleNaviosLaudo
GO
SELECT * INTO ControleNaviosLaudo FROM #Temp
GO
DROP TABLE #Temp
GO

--[20/04/2024 09:28:00]
EXEC sp_rename 'dbo.ControleNaviosLaudo.Obervacao', 'Observacao', 'COLUMN'
GO

--[23/04/2024 15:36:00]
ALTER TABLE Configuracao ADD Utiliza_ControleNavios bit
GO
UPDATE Configuracao SET Utiliza_ControleNavios = 0
GO
UPDATE Configuracao SET Utiliza_ControleNavios = 1 WHERE (SELECT count(*) FROM Cybersoft_Cadastros.dbo.Empresas WHERE CNPJ = '77696235000194') > 0
GO

--[24/04/2024 15:07:00]
ALTER TABLE Pedidos ADD Valor_BCII money
GO
ALTER TABLE NotasFiscais ADD Valor_BCII money
GO
UPDATE NotasFiscais SET Valor_BCII = (select sum(Valor_BCII) from NotasItens where Nota = Numero and Data = Data_Emissao)
GO
UPDATE Pedidos SET Valor_BCII = (select sum(Valor_BCII) from PedidosItens where Pedido = Numero)
GO

--[26/04/2024 11:33:00]
ALTER TABLE NotasItensNavios ADD BL varchar(15)
GO
ALTER TABLE PedidosItensNavios ADD BL varchar(15)
GO
ALTER TABLE PedidosItens ADD BL varchar(15)
GO
ALTER TABLE NotasItens ADD BL varchar(15)
GO
UPDATE PedidosItensNavios SET BL = (SELECT Numero_BL FROM ProcessosDocumentos WHERE Numero_Declaracao = DI)
GO
UPDATE NotasItensNavios SET BL = (SELECT Numero_BL FROM ProcessosDocumentos WHERE Numero_Declaracao = DI)
GO
UPDATE NotasItens SET BL = (SELECT Numero_BL FROM ProcessosDocumentos WHERE Numero_Declaracao = DI)
GO
UPDATE PedidosItens SET BL = (SELECT Numero_BL FROM ProcessosDocumentos WHERE Numero_Declaracao = DI)
GO


--[29/04/2024 10:27:00]
exec sp_RENAME 'ControleNaviosLaudo.Porto', 'Terminal', 'COLUMN'
GO
ALTER TABLE ControleNaviosBL ADD Terminal varchar(30)
GO
DROP TABLE ControleNavios
GO
ALTER TABLE ControleNaviosBL ALTER COLUMN BL varchar(15)
GO

--[29/04/2024 15:25:00]
DELETE FROM ControleNaviosBL WHERE Registro IS null
GO
DELETE FROM ControleNaviosLaudo WHERE Registro IS null
GO

--[02/05/2024 11:27:00]
ALTER TABLE TipoNota ADD Remessa bit
GO
UPDATE TipoNota SET Remessa = 0 WHERE Remessa is null
GO
ALTER TABLE Pedidos ADD Remessa bit
GO
UPDATE Pedidos SET Remessa = 0 WHERE Remessa is null
GO
ALTER TABLE NotasFiscais ADD Remessa bit
GO
UPDATE NotasFiscais SET Remessa = 0 WHERE Remessa is null
GO

--[03/05/2024 14:42:00]
UPDATE ControleNaviosBL SET DI = (SELECT Numero_Declaracao FROM ProcessosDocumentos pd WHERE pd.Navio_Ordem = Navio and pd.Numero_BL = BL) WHERE DI IS NULL
GO

--[07/05/2024 15:27:00]
ALTER TABLE ControleNaviosBL ADD Porto varchar(30)
GO
ALTER TABLE ControleNaviosBL ADD Armazem smallint
GO
ALTER TABLE ControleNaviosBL DROP COLUMN Terminal
GO

--[08/05/2024 14:42:00]
ALTER TABLE TipoNota ADD Transportador bit
GO
UPDATE TipoNota SET Transportador = 0
GO

--[09/05/2024 10:04:00]
ALTER TABLE ControleNaviosLaudo DROP COLUMN Terminal, Armazem
GO

--[13/05/2024 11:10:00]
EXEC sp_rename 'dbo.ControleNaviosBL.Quantidade_15', 'Quantidade_M315', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosBL.Quantidade_20', 'Quantidade_M320', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosLaudo.Quantidade_DeclaradaM3', 'Quantidade_M320', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosLaudo.Quantidade_DeclaradaLT', 'Quantidade_LT20', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosLaudo.Quantidade_RecebidaM3', 'Quantidade_RecebidaM320', 'COLUMN'
GO
EXEC sp_rename 'dbo.ControleNaviosLaudo.Quantidade_RecebidaLT', 'Quantidade_RecebidaLT20', 'COLUMN'
GO

--[14/05/2024 11:28:00]
ALTER TABLE ControleNaviosBL ADD Quantidade_EmbM315 float
                                ,Quantidade_EmbLT15 float
                                ,Quantidade_EmbM320 float
                                ,Quantidade_EmbLT20 float
GO

--[20/05/2024 15:30:00]
EXEC sp_rename 'dbo.PedidosRepresentantes.Terminal_EntregaCod', 'Armazem', 'COLUMN'
GO

--[21/05/2024 08:39:00]
ALTER TABLE NotasItensNavios ADD Armazem smallint
GO
UPDATE NotasItensNavios SET Armazem = (select Armazem from NotasFiscais nf where nf.Numero = NotasItensNavios.Nota)
GO

--[23/05/2024 09:29:00]
ALTER TABLE ControleNaviosBL ADD Codigo_Mercadoria int
GO
UPDATE ControleNaviosBL SET Codigo_Mercadoria = 3 WHERE Codigo_Mercadoria is null
GO

--[24/05/2024 10:34:00]
ALTER TABLE Produtos ADD Percentual_FECEP float
GO

--[12/06/2024 09:47:00]
ALTER TABLE ControleNaviosbl ADD Entreposto bit
GO

--[13/06/2024 11:45:00]
ALTER TABLE Adicoes ADD CIDE_Aliquota float
                       ,CIDE_ValorDevido money
                       ,CIDE_ValorRecolher money
GO

--[13/06/2024 14:46:00]
ALTER TABLE ProcessosDocumentos ADD CIDE_ValorDevido money
                                   ,CIDE_ValorRecolher money
GO

--[24/06/2024 13:43:00]
ALTER TABLE Configuracao ADD Obrigar_Armazem bit
GO
UPDATE Configuracao SET Obrigar_Armazem = 0 WHERE Obrigar_Armazem IS NULL
GO

--[09/07/2024 13:50:00]
CREATE TABLE DARFDUA (Registro int
                     ,Ano smallint
                     ,Mes smallint
                     ,Documento char(4)
                     ,Codigo_Imposto varchar(10)
                     ,Descricao_Imposto varchar(6)
                     ,Numero_Referencia varchar(15)
                     ,CNPJ varchar(14)
                     ,Filial smallint
                     ,Empresa varchar(60)
                     ,Data_Vencimento datetime
                     ,IE varchar(15)
                     ,Valor Money 
                     ,Codigo_Barras varchar(44) )
GO

--[10/07/2024 14:51:00]
ALTER TABLE Bancos ADD Rel_Fluxo_Caixa bit
GO

--[18/07/2024 15:34:00]
ALTER TABLE NotasTerceiros ADD Armazem smallint
GO

--[02/08/2024 15:44:00]
ALTER TABLE Configuracao ADD FTP_Pasta_Backup_Clientes varchar(120)
GO
UPDATE Configuracao SET FTP_Pasta_Backup_Clientes = 'Backup Clientes'
GO
ALTER TABLE Configuracao ADD Local_Limite_Bkp int 
GO
UPDATE Configuracao SET Local_Limite_Bkp = 1
GO

--[02/08/2024 16:08:00]
ALTER TABLE Configuracao ALTER COLUMN FTP_Pasta_Backup_Clientes varchar(120)
GO

--[16/08/2024 10:02:00]
ALTER TABLE Fornecedores ADD Indent_Operador varchar(11)
                            ,Codigo_DUIMP varchar(35) 
GO
ALTER TABLE Fabricantes ADD Indent_Operador varchar(11)
                           ,Codigo_DUIMP varchar(35) 
GO

--[28/08/2024 14:54:00]
ALTER TABLE TipoNota ALTER COLUMN Beneficio_Fiscal varchar(10)
GO
ALTER TABLE PedidosItens ALTER COLUMN Beneficio_Fiscal varchar(10)
GO
ALTER TABLE NotasItens ALTER COLUMN Beneficio_Fiscal varchar(10)
GO

--[28/08/2024 15:43:00]
SELECT * INTO PedidosItensNaviosRemessa FROM PedidosItensNavios
GO
TRUNCATE TABLE PedidosItensNaviosRemessa
GO

--[29/08/2024 11:24:00]
ALTER TABLE NCM ADD PIS_ST bit
GO
UPDATE NCM SET PIS_ST = 0 WHERE PIS_ST IS NULL
GO

--[30/08/2024 10:53:00]
ALTER TABLE Produtos ADD Codigo_DUIMP varchar(10)
GO
ALTER TABLE Fornecedores DROP COLUMN Indent_Operador
GO
ALTER TABLE Fornecedores ADD Ident_Operador VARCHAR(11)
GO
ALTER TABLE Clientes ADD Varejista bit
                        ,Atacadista bit
GO
UPDATE Clientes SET Atacadista = 0 WHERE Atacadista IS NULL
GO
UPDATE Clientes SET Varejista = 0 WHERE Varejista IS NULL
GO

--[04/09/2024 11:34:00]
ALTER TABLE Pedidos ADD Valor_PISST money
                       ,Valor_COFINSST money
GO
ALTER TABLE PedidosItens ADD Valor_PISST money
                            ,Valor_COFINSST money
GO
ALTER TABLE NotasFiscais ADD Valor_PISST money
                            ,Valor_COFINSST money
GO
ALTER TABLE NotasItens ADD Valor_PISST money
                          ,Valor_COFINSST money
GO
ALTER TABLE TipoNota ADD Calculo_PISST text
                        ,Formula_PISST text
                        ,Calculo_COFINSST text
                        ,Formula_COFINSST text
GO

--[11/09/2024 16:10:00]
ALTER TABLE PedidosRepresentantes ADD Bloqueado bit
GO

--[13/09/2024 14:44:00]
ALTER TABLE Produtos ALTER COLUMN Codigo_DUIMP int
GO

--[16/09/2024 10:29:00]
ALTER TABLE TipoNota ADD Classificacao_ICMSMono varchar(15)
                        ,Centro_CustoICMSMono char(10)
                        ,Tipo_DocumentoICMSMono char(10)
                        ,Modalidade_PagamentoICMSMOno smallint
                        ,Beneficiario_ICMSMono varchar(10)
GO

--[24/09/2024 17:13:00]
ALTER TABLE ICMS ADD ICMS_CreditoPresumido float
GO
ALTER TABLE TipoNota ADD Calculo_BCICMSPresumido text
                        ,Formula_BCICMSPresumido text
                        ,Calculo_ICMSPresumido text
                        ,Formula_ICMSPresumido text
GO
ALTER TABLE PedidosItens ADD Valor_BCICMSPresumido money
                            ,Aliquota_ICMSPresumido float
                            ,Valor_ICMSPresumido money
GO
ALTER TABLE Pedidos ADD Valor_BCICMSPresumido money
                       ,Valor_ICMSPresumido money
GO
ALTER TABLE NotasItens ADD Valor_BCICMSPresumido money
                          ,Aliquota_ICMSPresumido float
                          ,Valor_ICMSPresumido money
GO
ALTER TABLE NotasFiscais ADD Valor_BCICMSPresumido money
                            ,Valor_ICMSPresumido money
GO

--[14/10/2024 10:37:00]
ALTER TABLE Fornecedores ALTER COLUMN Email varchar(200)
GO
UPDATE Fornecedores set Enviar_Email = 1 where Enviar_Email is null
GO
UPDATE Fornecedores set Zona_Franca = 0 where Zona_Franca is null
GO
UPDATE Fornecedores set Simples = 0 where Simples is null
GO
UPDATE Fornecedores set MEI = 0 where MEI is null
GO
UPDATE Fornecedores set Micro_Empresa = 0 where Micro_Empresa is null
GO

--[17/10/2024 17:59:00]
DROP TABLE NCMAtributos
GO
DROP TABLE NCMAttDominios
GO

--[18/10/2024 15:22:00]
ALTER TABLE TipoNota ADD Visivel_Televendas bit
GO
UPDATE TipoNota SET Visivel_Televendas = iif(isnull(Saida_Entrada, 0) = 0, 0, 1)
GO

--[22/10/2024 09:53:00]
ALTER TABLE NotasFiscais ADD CCe bit
GO
UPDATE NotasFiscais SET CCe = IIF((SELECT COUNT(*) FROM CartaCorrecao cc WHERE cc.Chave = NotasFiscais.NFe_cNF) = 0, 0, 1)
GO

--[23/10/2024 16:00:00]
ALTER TABLE Boletos ADD Email_Enviado bit
GO
UPDATE Boletos SET Email_Enviado = 1 WHERE Email_Enviado is null
GO

--[23/10/2024 16:00:00]
CREATE TABLE ProdutosAtributos (NCM varchar(8)
                               ,Atributo varchar(25)
                               ,Codigo_Mercadoria smallint
                               ,Valor varchar(100)
                               )
GO

--[25/10/2024 10:07:00]
DROP TABLE NCMAtributos
GO
CREATE TABLE [dbo].[NCMAtributos](
	[NCM] [char](8) NOT NULL,
	[Atributo] [varchar](25) NOT NULL
) ON [PRIMARY]
GO
DROP TABLE ProdutosAtributos
GO
CREATE TABLE [dbo].[ProdutosAtributos](
	[Codigo_Mercadoria] [int] NOT NULL,
	[NCM] [varchar](8) NOT NULL,
	[Atributo] [varchar](25) NOT NULL,
	[Valor] [varchar](100) NOT NULL
) ON [PRIMARY]
GO

--[28/10/2024 16:06:00]
ALTER TABLE ICMS ADD Nac_Atacadista float
                    ,Imp_Atacadista float
                    ,Nac_Varejista float
                    ,Imp_Varejista float
GO
update ICMS SET Nac_Atacadista = Imp_Contribuinte
               ,Imp_Atacadista = Imp_Contribuinte
               ,Nac_Varejista  = Imp_Contribuinte
               ,Imp_Varejista  = Imp_Contribuinte
GO

--[10/08/2024 10:08:00]
ALTER TABLE Inventario add Processo varchar(30)
GO

--[12/11/2024 16:07:00]
ALTER TABLE Configuracao add Aviso_ExoneracaoICMS smallint
GO

--[14/11/2024 09:34:00]
ALTER TABLE NCM ADD Tratamento_TribICMS smallint
GO

--[25/11/2024 09:46:42]
ALTER TABLE ProcessosDocumentos ADD Numero_HouseBL varchar(15)
                                   ,Numero_TFA varchar(15)
                                   ,Transporte_Viagem varchar(15)
                                   ,Navio_PrevSaida datetime
GO

--[26/11/2024 10:19:21]
ALTER TABLE ProcessosDocumentos ADD Ultima_Atualizacao datetime
GO

--[26/11/2024 17:58:02]
ALTER TABLE NotasFiscais ADD Exonerada bit
GO
UPDATE NotasFiscais SET Exonerada = 0 WHERE Exonerada IS NULL
GO

--[29/11/2024 10:38:07]
ALTER TABLE ProcessosDocumentosDocs ALTER COLUMN Documento varchar(250)
GO

--[03/12/2024 09:35:05]
ALTER TABLE SimulaImportacao ADD Valor_AFRMM money
GO

--[18/12/2024 14:58:11]
ALTER TABLE Pedidos ADD Incentivo_Codigo int
GO
ALTER TABLE NotasFiscais ADD Incentivo_Codigo int
GO
UPDATE Pedidos SET Incentivo_Codigo = (select Codigo from cybersoft_Cadastros.dbo.IncentivosFiscais where Nome = Incentivo_Fiscal)
GO
UPDATE NotasFiscais SET Incentivo_Codigo = (select Codigo from cybersoft_Cadastros.dbo.IncentivosFiscais where Nome = Incentivo_Fiscal)
GO
ALTER TABLE Pedidos ADD Aliquota_ICMSPresumido float
GO
ALTER TABLE NotasFiscais ADD Aliquota_ICMSPresumido float
GO

--[19/12/2024 11:20:08]
ALTER TABLE ProcessosDocumentos ADD Exonerado bit
GO
UPDATE ProcessosDocumentos SET Exonerado = 1
GO

--[20/12/2024 11:39:28]
ALTER TABLE Configuracao ADD Prazo_Exoneracao smallint
GO
UPDATE Configuracao SET Prazo_Exoneracao = 15
GO

--[03/01/2025 14:43:11]
UPDATE Configuracao SET IP_Suporte = '187.64.131.96'
GO

--[22/01/2025 17:27:00]
ALTER TABLE TipoNota ADD Calculo_BCDIFALST text
                        ,Formula_BCDIFALST text
GO
ALTER TABLE TipoNota ADD Calculo_DIFALST text
                        ,Formula_DIFALST text
GO
ALTER TABLE Pedidos ADD Valor_BCDIFALST money
                       ,DIFAL_ValorST money
GO
ALTER TABLE PedidosItens ADD Valor_BCDIFALST money
                            ,DIFAL_ValorST money
GO
ALTER TABLE NotasFiscais ADD Valor_BCDIFALST money
                            ,DIFAL_ValorST money
GO
ALTER TABLE NotasItens ADD Valor_BCDIFALST money
                          ,DIFAL_ValorST money
GO

--[29/01/2025 10:50:00]
ALTER TABLE NCM ADD Codigo_cBenef varchar(8)
                   ,Codigo_CredPres varchar(8)
GO
UPDATE NCM SET Codigo_CredPres = 'SC850065' WHERE Codigo_CredPres IS NULL
GO
ALTER TABLE PedidosItens ADD Codigo_CredPres varchar(8)
GO
ALTER TABLE NotasItens ADD Codigo_CredPres varchar(8)
GO
UPDATE NotasItens SET Codigo_CredPres = (select Codigo_CredPres from NCM nc where nc.NCM = NotasItens.NCM) WHERE isnull(Beneficio_Fiscal, '') <> ''
GO

--[03/01/2025 14:43:11]
UPDATE Configuracao SET IP_Suporte = '187.64.131.96'
GO

--[22/01/2025 17:27:00]
ALTER TABLE TipoNota ADD Calculo_BCDIFALST text
                        ,Formula_BCDIFALST text
GO
ALTER TABLE TipoNota ADD Calculo_DIFALST text
                        ,Formula_DIFALST text
GO
ALTER TABLE Pedidos ADD Valor_BCDIFALST money
                       ,DIFAL_ValorST money
GO
ALTER TABLE PedidosItens ADD Valor_BCDIFALST money
                            ,DIFAL_ValorST money
GO
ALTER TABLE NotasFiscais ADD Valor_BCDIFALST money
                            ,DIFAL_ValorST money
GO
ALTER TABLE NotasItens ADD Valor_BCDIFALST money
                          ,DIFAL_ValorST money
GO

--[29/01/2025 10:50:00]
ALTER TABLE NCM ADD Codigo_cBenef varchar(8)
                   ,Codigo_CredPres varchar(8)
GO
UPDATE NCM SET Codigo_CredPres = 'SC850065' WHERE Codigo_CredPres IS NULL
GO
ALTER TABLE PedidosItens ADD Codigo_CredPres varchar(8)
GO
ALTER TABLE NotasItens ADD Codigo_CredPres varchar(8)
GO
UPDATE NotasItens SET Codigo_CredPres = (select Codigo_CredPres from NCM nc where nc.NCM = NotasItens.NCM) WHERE isnull(Beneficio_Fiscal, '') <> ''
GO

--[17/02/2025 09:53:00]
ALTER TABLE Imobilizado ADD Quantidade float
                           ,Unidade varchar(5)
GO

--[17/02/2025 16:49:00]
ALTER TABLE Imobilizado ADD Chave_Nota varchar(44)
GO

--[20/02/2025 12:28:00]
ALTER TABLE Bancos ADD Conta_Cliente int
GO

--[21/02/2025 15:30:00]
DELETE FROM PagarReceber WHERE isnull(Data_Vencimento, '') = '' and isnull(Valor_Total, 0) = 0 and isnull(Valor_Parcela, 0) = 0 and ISNULL(Valor_Operacao, 0) =0
GO

--[05/03/2025 09:25:00]
ALTER TABLE PedidosItensNavios ALTER COLUMN Codigo_Mercadoria int
GO
ALTER TABLE NotasItensNavios ALTER COLUMN Codigo_Mercadoria int
GO

--[05/03/2025 09:49:00]
ALTER TABLE PedidosItensNaviosRemessa ALTER COLUMN Codigo_Mercadoria int
GO
ALTER TABLE OrdemCompra ALTER COLUMN Codigo_Mercadoria int
GO
ALTER TABLE POItens ALTER COLUMN Codigo_Mercadoria int
GO

--[25/03/2025 10:59:00]
update Container set Data_Saida = null where Data_Saida = '1899-12-30 00:00:00.000'
GO

--[09/04/2025 15:59:00]
ALTER TABLE TipoNota add Fechamento_Processo bit
GO
UPDATE TipoNota SET Fechamento_Processo = 1 WHERE Finalidade_Mercadoria IN(0,2,5)
GO

--[14/04/2025 15:31:00]
ALTER TABLE ReferenciasFiscais add Fechamento_Processo bit
GO
UPDATE ReferenciasFiscais SET Fechamento_Processo = 1 WHERE Finalidade_Mercadoria IN(0,2,5)
GO

--[07/05/2025 16:19:00]
ALTER TABLE Configuracao ADD Boleto_IntervaloEmail smallint
GO
UPDATE Configuracao SET Boleto_IntervaloEmail = 5
GO

--[13/05/2025 11:10:00]
ALTER TABLE Configuracao ADD Prazo_NFDI smallint
                            ,Prazo_NFDA smallint
                            ,Prazo_NFDIDias smallint
                            ,Prazo_NFDADias smallint
GO

--[14/05/2025 11:33:00]
CREATE TABLE PagarReceberDocs (Titulo int
                              ,Documento varchar(250)
                              )
GO

--[16/05/2025 15:36:00]
ALTER TABLE TipoNota ADD Estornar_TituloDev bit
GO
UPDATE TipoNota SET Estornar_TituloDev = 0
GO

--[18/05/2025 09:33:00]
ALTER TABLE ContratoCambio ADD Filial smallint
GO
UPDATE ContratoCambio SET Filial = ISNULL((SELECT MAX(Filial) FROM PagarReceber WHERE Numero_Documento = ContratoCambio.Numero), 0)
GO

--[21/05/2025 10:59:00]
ALTER TABLE Adicoes ADD Fabricante int
                       ,Incoterm char(3)
GO

--[28/05/2025 16:01:00]
ALTER TABLE Produtos ADD Tributa_PISCOFINSST bit
GO

--[03/06/2025 09:35:00]
ALTER TABLE PedidosRepresentantes ALTER COLUMN Cliente int
GO

--[04/06/2025 09:26:00]
ALTER TABLE PagarReceber ALTER COLUMN Cliente int
GO
ALTER TABLE PagarReceber ALTER COLUMN Fornecedor int
GO

--[10/06/2025 12:49:00]
ALTER TABLE Boletos ALTER COLUMN Sacado int
GO

--[11/06/2025 09:04:00]
ALTER TABLE PagarReceberCreditos ALTER COLUMN Codigo int
GO

--[12/06/2025 10:08:00]
update PedidosRepresentantesItens set cancelado = (select Cancelado from PedidosRepresentantes pr where pr.Pedido = PedidosRepresentantesItens.Pedido)
GO

--[13/06/2025 11:37:00]
update NotasTerceiros set Codigo_Adicional01 = replace(Codigo_Adicional01, ' ', '')
                         ,Codigo_Adicional02 = replace(Codigo_Adicional02, ' ', '')
                         ,Codigo_Adicional03 = replace(Codigo_Adicional03, ' ', '')
                         ,Codigo_Adicional04 = replace(Codigo_Adicional04, ' ', '')
                         ,Codigo_Adicional05 = replace(Codigo_Adicional05, ' ', '')
                         ,Codigo_Adicional06 = replace(Codigo_Adicional06, ' ', '')
GO
update NotasServico  set Codigo_Adicional01 = replace(Codigo_Adicional01, ' ', '')
                        ,Codigo_Adicional02 = replace(Codigo_Adicional02, ' ', '')
                        ,Codigo_Adicional03 = replace(Codigo_Adicional03, ' ', '')
                        ,Codigo_Adicional04 = replace(Codigo_Adicional04, ' ', '')
                        ,Codigo_Adicional05 = replace(Codigo_Adicional05, ' ', '')
                        ,Codigo_Adicional06 = replace(Codigo_Adicional06, ' ', '')
GO
update PedidosServico  set Codigo_Adicional01 = replace(Codigo_Adicional01, ' ', '')
                          ,Codigo_Adicional02 = replace(Codigo_Adicional02, ' ', '')
                          ,Codigo_Adicional03 = replace(Codigo_Adicional03, ' ', '')
                          ,Codigo_Adicional04 = replace(Codigo_Adicional04, ' ', '')
                          ,Codigo_Adicional05 = replace(Codigo_Adicional05, ' ', '')
                          ,Codigo_Adicional06 = replace(Codigo_Adicional06, ' ', '')
GO

--[13/06/2025 17:17:00]
alter table Clientes ADD Prospeccao bit
GO
update Clientes SET Prospeccao = 0 where Prospeccao is null
GO

--[20/06/2025 14:47:00]
update PedidosRepresentantes set Planilha = Pedido where Origem_Pedido = 'TELEVENDAS'
GO

--[23/06/2025 10:47:00]
alter table TipoNota ADD Formula_BCPISST text
                        ,Calculo_BCPISST text
GO
alter table NotasItens ADD Valor_BCPISST money
                         ,Valor_BCCOFINSST money
GO
alter table NotasFiscais ADD Valor_BCPISST money
                         ,Valor_BCCOFINSST money
GO
alter table PedidosItens ADD Valor_BCPISST money
                         ,Valor_BCCOFINSST money
GO
alter table Pedidos ADD Valor_BCPISST money
                         ,Valor_BCCOFINSST money
GO

--[26/06/2025 17:22:00]
alter table Pedidos alter column NFe_Protocolo varchar(17)
GO
alter table NotasFiscais alter column NFe_Protocolo varchar(17)
GO

--[27/06/2025 10:34:00]
alter table Configuracao add EnviarNFe_API bit
GO
update Configuracao set EnviarNFe_API = 0
GO

--[07/07/2025 09:47:00]
alter table TipoNota add IPI_Devolucao bit
GO
update TipoNota set IPI_Devolucao = 0 where IPI_Devolucao is null
GO
alter table Pedidos add Valor_IPIDevol money
GO
alter table PedidosItens add Valor_IPIDevol money
GO
alter table NotasFiscais add Valor_IPIDevol money
GO
alter table NotasItens add Valor_IPIDevol money
GO

--[09/07/2025 17:29:00]
alter table NotasTerceiros add Retencao_ISS bit
GO
update NotasTerceiros set Retencao_ISS = 1 where Retencao_ISS is null and (Codigo_Adicional01 = 'ISS' or Codigo_Adicional02 = 'ISS' or Codigo_Adicional03 = 'ISS' or Codigo_Adicional04 = 'ISS' or Codigo_Adicional05 = 'ISS' or Codigo_Adicional06 = 'ISS')
GO

--[10/07/2025 11:58:00]
alter table PedidosItens add Percentual_IPIDevol float
GO
alter table NotasItens add Percentual_IPIDevol float
GO

--[19/07/2025 16:01:00]
alter table TipoNota add Devolucao_Importacao bit
GO
update TipoNota set Devolucao_Importacao = 0 where Devolucao_Importacao is null
GO

--[22/07/2025 10:53:00]
alter table Configuracao add Gerar_TituloSolictacaoNumTotal bit
                            ,Gerar_TituloSolictacaoNumItem bit
GO
update Configuracao set Gerar_TituloSolictacaoNumTotal = 1 where Gerar_TituloSolictacaoNumTotal is null
GO
update Configuracao set Gerar_TituloSolictacaoNumItem  = 1 where Gerar_TituloSolictacaoNumItem is null
GO

--[22/07/2025 17:28:00]
alter table Log add Detalhe text
GO

--[31/07/2025 14:47:00]
alter table Configuracao add Layout_Nfe smallint
GO
update Configuracao set Layout_Nfe = 0 where Layout_Nfe is null
GO

--[04/08/2025 11:34:00]
alter table TipoNota add Formula_BCIBS text
                        ,Calculo_BCIBS text
                        ,Formula_VlrIBS text
                        ,Calculo_VlrIBS text
			,Formula_BCCBS text
			,Calculo_BCCBS text
			,Formula_VlrCBS text
			,Calculo_VlrCBS text
			,Formula_BCIS text
			,Calculo_BCIS text
			,Formula_VlrIS text
			,Calculo_VlrIS text
GO

--[05/08/2025 11:24:00]
alter table Pedidos add Valor_BCIBS money
                       ,Valor_IBS money
                       ,Valor_BCCBS money
                       ,Valor_CBS money
                       ,Valor_BCIS money
                       ,Valor_IS money
GO
alter table PedidosItens add Valor_BCIBS money
                            ,Aliquota_IBS float
                            ,Valor_IBS money
                            ,Valor_BCCBS money
                            ,Aliquota_CBS float
                            ,Valor_CBS money
                            ,Valor_BCIS money
                            ,Aliquota_IS float
                            ,Valor_IS money
GO
alter table NotasFiscais add Valor_BCIBS money
                            ,Valor_IBS money
                            ,Valor_BCCBS money
                            ,Valor_CBS money
                            ,Valor_BCIS money
                            ,Valor_IS money
GO
alter table NotasItens add Valor_BCIBS money
                          ,Aliquota_IBS float
                          ,Valor_IBS money
                          ,Valor_BCCBS money
                          ,Aliquota_CBS float
                          ,Valor_CBS money
                          ,Valor_BCIS money
                          ,Aliquota_IS float
                          ,Valor_IS money
GO
alter table NotasTerceiros add Valor_BCIBS money
                              ,Valor_IBS money
                              ,Valor_BCCBS money
                              ,Valor_CBS money
                              ,Valor_BCIS money
                              ,Valor_IS money
GO
alter table NotasTerceirosItens add Valor_BCIBS money
                                   ,Aliquota_IBS float
                                   ,Valor_IBS money
                                   ,Valor_BCCBS money
                                   ,Aliquota_CBS float
                                   ,Valor_CBS money
                                   ,Valor_BCIS money
                                   ,Aliquota_IS float
                                   ,Valor_IS money
GO

--[05/08/2025 15:21:00]
alter table NotasItensNavios alter column DI varchar(15)
go
alter table AdicoesAcrescimo alter column DI varchar(15)
go
alter table ControleNaviosBL alter column DI varchar(15)
go
alter table DI alter column DI varchar(15)
go
alter table DIAcrescimo alter column DI varchar(15)
go
alter table DIAdicoes alter column DI varchar(15)
go
alter table DIDocumentos alter column DI varchar(15)
go
alter table DISeriais alter column DI varchar(15)
go
alter table Invoice alter column DI varchar(15)
go
alter table PedidosItensNavios alter column DI varchar(15)
go
alter table PedidosItensNaviosRemessa alter column DI varchar(15)
go

--[22/08/2025 13:49:00]
update NotasItens set Valor_BCPISST    = cast(Valor_Total + (Valor_IPI*Quantidade) - Valor_ICMSOper as decimal(18, 2))
                     ,Valor_BCCOFINSST = cast(Valor_Total + (Valor_IPI*Quantidade) - Valor_ICMSOper as decimal(18, 2))
GO
update NotasItens set Valor_PISST    = Valor_BCPISST * (Aliquota_PIS/100)
                     ,Valor_COFINSST = Valor_BCCOFINSST * (Aliquota_COFINS/100)
GO
update NotasFiscais set Valor_BCPISST    = cast(isnull((select sum(isnull(Valor_BCPISST, 0)) from NotasItens where Nota = Numero), 0) as decimal(18, 2))
                       ,Valor_BCCOFINSST = cast(isnull((select sum(isnull(Valor_BCCOFINSST, 0)) from NotasItens where Nota = Numero), 0) as decimal(18, 2))
GO
update NotasFiscais set Valor_PISST    = cast(isnull((select sum(isnull(Valor_PISST, 0)) from NotasItens where Nota = Numero), 0) as decimal(18, 2))
                       ,Valor_COFINSST = cast(isnull((select sum(isnull(Valor_COFINSST, 0)) from NotasItens where Nota = Numero), 0) as decimal(18, 2))
GO

--[26/08/2025 08:32:00]
update NotasFiscais set Valor_BCPIS = (select sum(isnull(valor_BCPIS, 0)) from NotasItens where Nota = Numero)
where round(Valor_BCPIS, 2) <> round((select sum(isnull(Valor_BCPIS, 0)) from Notasitens where Nota = Numero), 2)
and Cancelada <> 1
and Nfe_Denegada <> 1
go

--[01/09/2025 08:42:00]
alter table ICMS add Nfe_Envio smallint
go
update ICMS set Nfe_Envio = 1 where Nfe_Envio is null
go

--[03/09/2025 16:38:00]
alter table PedidosItens add CSTIBS varchar(3)
                            ,CSTCBS varchar(3)
go
alter table NotasItens add CSTIBS varchar(3)
                          ,CSTCBS varchar(3)
go
alter table NotasTerceirosItens add CSTIBS varchar(3)
                                   ,CSTCBS varchar(3)
go

--[30/09/2025 11:16:00]
alter table ProcessosDocumentos alter column Numero_BL varchar(20)
go

--[10/11/2025 10:23:00]
alter table Bancos add Chave_PIX varchar(60)
go

--[12/11/2025 19:20:00]
alter table Boletos add QRCode text
go

--[13/11/2025 13:52:00]
alter table PedidosFatura add Serie_Nota char(3)
go
alter table Fatura add Serie_Nota char(3)
go
update Fatura set Serie_Nota = (select Serie from NotasFiscais where Numero = Nota and Data_Emissao = Data_Nota)
go

--[19/11/2025 10:23:00]
alter table Bancos add Chave_PIX varchar(60)
go

--[26/11/2025 10:04:00]
alter table Produtos Add Aliquota_CBS float
go
update Produtos set Aliquota_CBS = 0.9
go
alter table ICMS add Aliquota_IBS float
go
update ICMS set Aliquota_IBS = 0.1
go

--[05/12/2025 11:09:00]
alter table TipoNota add Classificacao_Tributaria varchar(6)
go
update TipoNota set Classificacao_Tributaria = '000001'
go
alter table NCM add IBS_Isencao bit
                   ,IBS_Imunidade bit
		   ,IBS_Diferido bit
		   ,IBS_Suspensao bit
		   ,CBS_Isencao bit
                   ,CBS_Imunidade bit
		   ,CBS_Diferido bit
		   ,CBS_Suspensao bit
go
alter table TipoNota add IBS_Isencao bit
                        ,IBS_Imunidade bit
	  	        ,IBS_Diferido bit
	 	        ,IBS_Suspensao bit
 		        ,CBS_Isencao bit
                        ,CBS_Imunidade bit 
		        ,CBS_Diferido bit
		        ,CBS_Suspensao bit
go
update NCM set IBS_Isencao = 0
                   ,IBS_Imunidade  = 0
		   ,IBS_Diferido  = 0
		   ,IBS_Suspensao  = 0
		   ,CBS_Isencao  = 0
                   ,CBS_Imunidade  = 0
		   ,CBS_Diferido  = 0
		   ,CBS_Suspensao  = 0
go
update TipoNota set IBS_Isencao = 0
                   ,IBS_Imunidade  = 0
		   ,IBS_Diferido  = 0
		   ,IBS_Suspensao  = 0
		   ,CBS_Isencao  = 0
                   ,CBS_Imunidade  = 0
		   ,CBS_Diferido  = 0
		   ,CBS_Suspensao  = 0
go


--[18/12/2025 19:13:00]
alter table DI add Moeda_FOB smallint
go
alter table DI alter column Tipo_DocCarga varchar(10)
go
alter table di alter column Pais_Procedencia varchar(4)
go
alter table DI add Motivo_SitEspecial varchar(16)
go

--[19/12/2025 16:05:00]
alter table DIAdicoes add Aliquota_RedIPI float
go
alter table DI add Adquirente smallint
go

--[20/12/2025 05:58:00]
alter table Fornecedores add Codigo_Estrangeiro varchar(20)
go
alter table Fabricantes add Codigo_Estrangeiro varchar(20)
go
alter table Fabricantes add Ident_Operador varchar(20)
go
alter table InvoiceItens add Vinculo_CompVend varchar(32)
go
alter table Invoice alter column Aplicacao varchar(23)
go
alter table NCM add Quantidade_Estatistica float
go
update NCM set Quantidade_Estatistica = 1 where Quantidade_Estatistica is null
go
alter table DI add Fatura_Numero varchar(40)
go
alter table NCM add Exige_LPCO bit
go
update NCM set Exige_LPCO = 0 where Exige_LPCO is null
go

--[22/12/2025 11:28:00]
drop table LPCO 
go
create table LPCO (LPCO int identity
                  ,Orgao_Anuente varchar(10)
                  ,Documento varchar(30)
                  ,Numero varchar(30)
                  ,Data_Inicio datetime
                  ,Data_Fim datetime )
go
create table InvoiceItensLPCO (Registro int identity
                              ,Invoice varchar(30)
                              ,Codigo_Mercadoria smallint
                              ,LPCO int )
go

--[22/12/2025 16:39:00]
alter table PedidosItens add Valor_COFINSDiferenca money
go
alter table NotasItens add Valor_COFINSDiferenca money
go
alter table TiposProcesso add Classificacao_COFINSDifer varchar(15)
go

--[23/12/2025 19:26:00]
alter table InvoiceItens add Certificado_MercoSulTipo char(5)
                            ,Certificado_MercoSulNumero varchar(20)
                            ,Certificado_MercoSulQtde float
go

--[24/12/2025 10:54:00]
alter table Invoice alter column Cobertura_Cambial varchar(15)
go
alter table Invoice add Numero_ROF varchar(8)
                       ,Valor_CoberturaCambial money
go

--[02/01/2026 17:09:00]
create table Industrializacao (Registro int identity
                              ,Codigo_Mercadoria int
                              ,Quantidade float
                              ,Valor_Unitario money 
                              ,Data datetime
                              ,Nota int
                              ,Data_Nota datetime
                              ,Processo varchar(15)
                              ,Movimenta_Estoque bit
                              ,Movimenta_Inventario bit)
go

--[04/01/2026 10:06:00]
alter table ProdutosTransferencia alter column Motivo char(3)
go
update ProdutosTransferencia set Motivo = 'TRF' where Motivo = 'T'
go

--[05/01/2026 09:27:00]
alter table Configuracao add Aliquota_CBS float
go
update Configuracao set Aliquota_CBS = 0.9
go